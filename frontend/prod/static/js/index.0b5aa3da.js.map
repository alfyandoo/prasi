{"version":3,"file":"static/js/index.0b5aa3da.js","sources":["/Users/riz/Developer/prasi/backend/utils/src/use-local.ts","/Users/riz/Developer/prasi/backend/utils/src/wait-until.ts","/Users/riz/Developer/prasi/backend/utils/src/use-global.ts","/Users/riz/Developer/prasi/backend/utils/src/define-react.ts","/Users/riz/Developer/prasi/backend/utils/src/define-window.ts","/Users/riz/Developer/prasi/frontend/src/nova/prod/base/base.tsx","/Users/riz/Developer/prasi/frontend/src/nova/prod/main.tsx","/Users/riz/Developer/prasi/frontend/src/utils/ui/deadend.tsx","/Users/riz/Developer/prasi/frontend/src/utils/ui/loading.tsx","/Users/riz/Developer/prasi/frontend/src/nova/vi/load/load.tsx","/Users/riz/Developer/prasi/frontend/src/nova/vi/render/global.tsx","/Users/riz/Developer/prasi/frontend/src/nova/vi/utils/error-box.tsx","/Users/riz/Developer/prasi/frontend/src/nova/ed/panel/side/style/tools/responsive-val.ts","/Users/riz/Developer/prasi/frontend/src/utils/css/advanced.ts","/Users/riz/Developer/prasi/frontend/src/utils/css/background.ts","/Users/riz/Developer/prasi/frontend/src/utils/css/border.ts","/Users/riz/Developer/prasi/frontend/src/utils/css/dimension.ts","/Users/riz/Developer/prasi/frontend/src/utils/css/editor.ts","/Users/riz/Developer/prasi/frontend/src/utils/css/font.ts","/Users/riz/Developer/prasi/frontend/src/utils/css/layout.ts","/Users/riz/Developer/prasi/frontend/src/utils/css/padding.ts","/Users/riz/Developer/prasi/frontend/src/utils/css/gen.ts","/Users/riz/Developer/prasi/frontend/src/nova/vi/render/parts.tsx","/Users/riz/Developer/prasi/frontend/src/nova/ed/logic/ed-global.ts","/Users/riz/Developer/prasi/frontend/src/nova/vi/render/script/arg.tsx","/Users/riz/Developer/prasi/frontend/src/nova/vi/render/script/code-build.ts","/Users/riz/Developer/prasi/frontend/src/utils/types/general.ts","/Users/riz/Developer/prasi/frontend/src/nova/vi/render/script/extract-nav.tsx","/Users/riz/Developer/prasi/frontend/src/nova/vi/render/script/passprop.tsx","/Users/riz/Developer/prasi/frontend/src/nova/vi/render/script/local.tsx","/Users/riz/Developer/prasi/frontend/src/nova/vi/render/script/item-dev.ts","/Users/riz/Developer/prasi/frontend/src/nova/vi/render/script/item-prod.ts","/Users/riz/Developer/prasi/frontend/src/nova/vi/render/script/eval-script.tsx","/Users/riz/Developer/prasi/frontend/src/nova/vi/render/script/eval-prop.tsx","/Users/riz/Developer/prasi/frontend/src/nova/vi/render/script.tsx","/Users/riz/Developer/prasi/frontend/src/nova/vi/render/render.tsx","/Users/riz/Developer/prasi/frontend/src/nova/vi/exts/notif.ts","/Users/riz/Developer/prasi/frontend/src/nova/vi/exts/types.ts","/Users/riz/Developer/prasi/frontend/src/nova/vi/exts/init.ts","/Users/riz/Developer/prasi/frontend/src/nova/vi/root.tsx","/Users/riz/Developer/prasi/frontend/src/nova/vi/vi.tsx","/Users/riz/Developer/prasi/frontend/src/nova/prod/base/component.tsx","/Users/riz/Developer/prasi/frontend/src/nova/prod/base/page.tsx","/Users/riz/Developer/prasi/frontend/src/nova/prod/base/responsive.tsx","/Users/riz/Developer/prasi/frontend/src/base/load/proxy.ts","/Users/riz/Developer/prasi/frontend/src/base/load/api/api-proxy-def.tsx","/Users/riz/Developer/prasi/frontend/src/base/load/api/api-proxy.tsx","/Users/riz/Developer/prasi/frontend/src/base/load/db/db-proxy.tsx","/Users/riz/Developer/prasi/frontend/src/nova/vi/meta/comp/instantiate.tsx","/Users/riz/Developer/prasi/frontend/src/nova/vi/meta/comp/walk-prop.tsx","/Users/riz/Developer/prasi/frontend/src/nova/vi/meta/simplify.tsx","/Users/riz/Developer/prasi/frontend/src/nova/vi/meta/comp.tsx","/Users/riz/Developer/prasi/frontend/src/nova/vi/meta/meta.ts","/Users/riz/Developer/prasi/frontend/src/nova/prod/base/route.tsx","/Users/riz/Developer/prasi/frontend/src/nova/prod/root.tsx","/Users/riz/Developer/prasi/frontend/src/nova/prod/w.ts"],"sourcesContent":["import { useEffect, useRef, useState } from \"react\";\n\nexport const useLocal = <T extends object>(\n  data: T,\n  effect?: (arg: {\n    init: boolean;\n    setDelayedRender: (arg: boolean) => void;\n  }) => Promise<void | (() => void)> | void | (() => void),\n  deps?: any[]\n): {\n  [K in keyof T]: T[K] extends Promise<any> ? null | Awaited<T[K]> : T[K];\n} & { render: () => void } => {\n  const [, _render] = useState({});\n  const _ = useRef({\n    data: data as unknown as T & {\n      render: () => void;\n    },\n    deps: (deps || []) as any[],\n    ready: false,\n    _loading: {} as any,\n    lastRender: 0,\n    lastRenderCount: 0,\n    delayedRender: false,\n    delayedRenderTimeout: null as any,\n    overRenderTimeout: null as any,\n  });\n  const local = _.current;\n\n  useEffect(() => {\n    local.ready = true;\n    if (effect)\n      effect({\n        init: true,\n        setDelayedRender(arg) {\n          local.delayedRender = arg;\n        },\n      });\n  }, []);\n\n  if (local.ready === false) {\n    local._loading = {};\n\n    local.data.render = () => {\n      if (local.ready) {\n        if (local.delayedRender) {\n          if (Date.now() - local.lastRender > 100) {\n            local.lastRender = Date.now();\n            _render({});\n          } else {\n            clearTimeout(local.delayedRenderTimeout);\n            local.delayedRenderTimeout = setTimeout(local.data.render, 50);\n          }\n          return;\n        }\n\n        if (Date.now() - local.lastRender < 300) {\n          local.lastRenderCount++;\n        } else {\n          local.lastRenderCount = 0;\n        }\n\n        local.lastRender = Date.now();\n\n        if (local.lastRenderCount > 300) {\n          clearTimeout(local.overRenderTimeout);\n          local.overRenderTimeout = setTimeout(() => {\n            local.lastRenderCount = 0;\n            local.lastRender = Date.now();\n            _render({});\n          }, 1000);\n\n          console.error(\n            `local.render executed ${local.lastRenderCount} times in less than 300ms`\n          );\n          return;\n        }\n\n        _render({});\n      }\n    };\n  } else {\n    if (local.deps.length > 0 && deps) {\n      for (const [k, dep] of Object.entries(deps) as any) {\n        if (local.deps[k] !== dep) {\n          local.deps[k] = dep;\n\n          if (effect) {\n            setTimeout(() => {\n              effect({\n                init: false,\n                setDelayedRender(arg) {\n                  local.delayedRender = arg;\n                },\n              });\n            });\n          }\n          break;\n        }\n      }\n    }\n  }\n\n  return local.data as any;\n};\n","export const waitUntil = (\n  condition: number | (() => any),\n  timeout?: number\n) => {\n  return new Promise<void>(async (resolve) => {\n    if (typeof condition === \"function\") {\n      let tout = null as any;\n      if (timeout) {\n        tout = setTimeout(resolve, timeout);\n      }\n      if (await condition()) {\n        clearTimeout(tout);\n        resolve();\n        return;\n      }\n      let count = 0;\n      const c = setInterval(async () => {\n        if (await condition()) {\n          if (tout) clearTimeout(tout);\n          clearInterval(c);\n          resolve();\n        }\n        if (count > 100) {\n          clearInterval(c);\n        }\n      }, 10);\n    } else if (typeof condition === \"number\") {\n      setTimeout(() => {\n        resolve();\n      }, condition);\n    }\n  });\n};\n","import {\n  createContext,\n  startTransition,\n  useContext,\n  useEffect,\n  useState,\n} from \"react\";\nexport const GlobalContext = createContext({\n  global: {},\n  render: () => {},\n} as {\n  global: Record<string, any>;\n  render: (reset?: boolean) => void;\n});\nimport decircular from \"decircular\";\n\nexport const uState = useState;\nexport const useGlobal = <T extends object>(\n  defaultValue: T,\n  id: string\n): T & { render: (reset?: boolean) => void } => {\n  const ctx = useContext(GlobalContext);\n  const { global, render } = ctx;\n\n  if (!global[id]) {\n    global[id] = defaultValue;\n  }\n\n  useEffect(() => {\n    let res: any = null;\n    return () => {\n      if (typeof res === \"function\") res();\n      else if (res instanceof Promise) {\n        res.then((e) => {\n          if (typeof e === \"function\") e();\n        });\n      }\n    };\n  }, []);\n\n  const res = global[id];\n\n  if (res) {\n    res.render = (reset?: boolean) => {\n      if (reset) {\n        global[id] = undefined;\n      }\n      startTransition(render);\n    };\n  }\n\n  return res as any;\n};\n\nexport const deepClone = decircular;\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport JSXDevRuntime from \"react/jsx-dev-runtime\";\nimport JSXRuntime from \"react/jsx-runtime\";\n\nexport const defineReact = () => {\n  const w = typeof window === \"object\" ? window : (globalThis as any);\n\n  w.React = React;\n  w.ReactDOM = ReactDOM;\n  w.JSXRuntime = JSXRuntime;\n  w.JSXDevRuntime = JSXDevRuntime;\n  w.Fragment = React.Fragment;\n};\n","import { css, extractCss } from \"goober\";\nimport { waitUntil } from \"prasi-utils\";\n\nexport const defineWindow = async (awaitServerUrl = true) => {\n  let w = typeof window === \"object\" ? window : (globalThis as any);\n\n  if (awaitServerUrl) await waitUntil(() => w.__SRV_URL__);\n\n  w.prasiContext = {\n    global: {},\n    render() {},\n  };\n\n  const location = window[\"location\"];\n\n  const host =\n      0 === location.protocol.indexOf(\"http\") ? location.hostname : \"localhost\",\n    scheme =\n      \"https:\" != location.protocol || /localhost|127.0.0.1|0.0.0.0/.test(host)\n        ? \"http\"\n        : \"https\";\n\n  if (w.__SRV_URL__) {\n    w.serverurl = w.__SRV_URL__;\n    const serverURL = new URL(w.serverurl);\n    if (\n      serverURL.hostname === \"localhost\" ||\n      serverURL.hostname === \"127.0.0.1\"\n    ) {\n      serverURL.hostname = location.hostname;\n      serverURL.pathname = serverURL.pathname === \"/\" ? \"\" : serverURL.pathname;\n      w.serverurl = serverURL.toString();\n      if (w.serverurl.endsWith(\"/\")) {\n        w.serverurl = w.serverurl.substring(0, w.serverurl.length - 1);\n      }\n    }\n  }\n\n  const port = location.port;\n  w.baseurl = scheme + \"://\" + host + (port ? \":\" + port : \"\") + \"/\";\n  if (!w.basepath) {\n    w.basepath = \"/\";\n  }\n  w.css = css;\n  w.extractCss = extractCss;\n  w.pathname = location.pathname;\n\n  w.cx = (...classNames: any[]) => {\n    const result: string[] = [];\n\n    classNames\n      .filter((e) => {\n        if (e) {\n          if (typeof e === \"string\" && e.trim()) return true;\n          else return true;\n        }\n        return false;\n      })\n      .forEach((e) => {\n        if (Array.isArray(e)) {\n          for (const f of e) {\n            if (typeof f === \"string\" && f.trim()) {\n              result.push(f.trim());\n            }\n          }\n        } else result.push(e.trim());\n      });\n    return result.join(\" \");\n  };\n\n  w.navigate = (href: string) => {\n    let _href = href;\n\n    if (typeof w.navigateOverride === \"function\") {\n      _href = w.navigateOverride(href);\n      if (!_href) return null;\n    }\n\n    history.pushState({ prevUrl: window.location.href }, \"\", _href);\n    w.pathname = href;\n\n    if (w.prasiContext && w.prasiContext.render) {\n      w.prasiContext.render();\n    }\n  };\n\n  if (typeof window === \"object\") {\n    window.addEventListener(\"popstate\", () => {\n      const sw = navigator.serviceWorker.controller;\n      if (sw) {\n        sw.postMessage({\n          type: \"add-cache\",\n          url: location.href,\n        });\n      }\n      if (w.prasiContext.popState) {\n        w.prasiContext.popState();\n        return;\n      }\n\n      if (w.preventPopRender) {\n        w.preventPopRender = false;\n        return;\n      }\n      if (w.prasiContext && w.prasiContext.render) {\n        w.pathname = location.pathname;\n        w.prasiContext.render();\n      }\n    });\n  }\n};\n","import { RadixRouter } from \"radix3\";\nimport { IItem } from \"../../../utils/types/item\";\nimport { IRoot } from \"../../../utils/types/root\";\nimport { PG } from \"../../ed/logic/ed-global\";\nimport { IMeta } from \"../../vi/utils/types\";\n\nconst w = window as any;\n\nexport const base = {\n  root: null as unknown as URL,\n  url(...arg: any[]) {\n    const pathname = arg\n      .map((e) => (Array.isArray(e) ? e.join(\"\") : e))\n      .join(\"\");\n\n    let base_url = this.root.toString();\n    if (base_url.endsWith(\"/\"))\n      base_url = base_url.substring(0, base_url.length - 1);\n\n    if (pathname.startsWith(\"/\")) return base_url + pathname;\n    else {\n      return base_url + \"/\" + pathname;\n    }\n  },\n  get pathname() {\n    const res = location.pathname.substring(base.root.pathname.length);\n    if (!res.startsWith(\"/\")) return `/${res}`;\n    return res;\n  },\n  site: { id: w._prasi?.site_id } as {\n    id: string;\n    name: string;\n    responsive: PG[\"site\"][\"responsive\"];\n    domain: string;\n    api_url: string;\n    code: {\n      mode: \"new\" | \"vsc\";\n    };\n    api: any;\n    db: any;\n  },\n  init_local_effect: {} as any,\n  mode: \"\" as \"desktop\" | \"mobile\",\n  route: {\n    status: \"init\" as \"init\" | \"loading\" | \"ready\",\n    pages: [] as { id: string; url: string }[],\n    router: null as null | RadixRouter<{ id: string; url: string }>,\n  },\n  comp: {\n    list: {} as Record<string, IItem>,\n    pending: {} as Record<string, IItem[]>,\n  },\n  layout: {\n    id: \"\",\n    root: null as null | IRoot,\n    meta: null as null | Record<string, IMeta>,\n  },\n  cache: {\n    urls: new Set<string>(),\n  },\n  page: {\n    id: \"\",\n    url: \"\",\n    root: null as null | IRoot,\n    meta: null as null | Record<string, IMeta>,\n    cache: {} as Record<\n      string,\n      {\n        id: string;\n        url: string;\n        root: IRoot;\n        meta: Record<string, IMeta>;\n      }\n    >,\n  },\n};\n\nexport const initBaseConfig = () => {\n  if (!base.root) {\n    let url = new URL(location.href);\n    if (w._prasi.basepath) {\n      url.pathname = w._prasi.basepath;\n    }\n\n    base.root = new URL(`${url.protocol}//${url.host}${url.pathname}`);\n    if (base.root.pathname.endsWith(\"/\")) {\n      base.root.pathname = base.root.pathname.substring(\n        0,\n        base.root.length - 1\n      );\n    }\n  }\n};\n","import { createRoot } from \"react-dom/client\";\nimport { defineReact, defineWindow } from \"prasi-utils\";\nimport { initBaseConfig } from \"./base/base\";\nimport { Root, isPreview } from \"./root\";\nimport { w } from \"./w\";\nimport \"../../index.css\";\n\n\n(async () => {\n  import(\"./font\");\n  initBaseConfig();\n  const div = document.getElementById(\"root\");\n  if (div) {\n    await defineWindow(false);\n\n    let react = {\n      root: createRoot(div),\n    };\n    defineReact();\n\n    try {\n      let internal_url = \"/_prasi/code/internal.js\";\n      if (location.pathname.startsWith(\"/prod\")) {\n        const patharr = location.pathname.split(\"/\");\n        internal_url = `/prod/${patharr[2]}${internal_url}`;\n      }\n\n      const prasi_internal = await import(internal_url);\n      if (typeof prasi_internal === \"object\") {\n        const w = window as any;\n        if (prasi_internal.Loading) w.ContentLoading = prasi_internal.Loading;\n        if (prasi_internal.NotFound)\n          w.ContentNotFound = prasi_internal.NotFound;\n      }\n    } catch (e) {}\n\n    w.navigateOverride = (_href: string) => {\n      if (_href && _href.startsWith(\"/\")) {\n        if (isPreview()) {\n          if (\n            location.pathname.startsWith(\"/prod\") &&\n            !_href.startsWith(\"/prod\")\n          ) {\n            const patharr = location.pathname.split(\"/\");\n            _href = `/prod/${patharr[2]}${_href}`;\n          }\n        }\n      }\n      return _href;\n    };\n\n    react.root.render(<Root />);\n    if (document.body.classList.contains(\"opacity-0\")) {\n      document.body.classList.remove(\"opacity-0\");\n    }\n  }\n})();\n","import { FC } from \"react\";\n\nconst w = window as any;\n\nexport const DeadEnd: FC<{ children: any; back?: () => void }> = ({\n  children,\n  back,\n}) => {\n  if (w.ContentNotFound) {\n    return <w.ContentNotFound />;\n  }\n\n  return (\n    <div className=\"flex items-center justify-center w-full h-full fixed inset-0 flex-col\">\n      <div>{children}</div>\n      <div\n        className=\"border mt-2 rounded-md p-2 cursor-pointer\"\n        onClick={\n          back\n            ? back\n            : () => {\n                history.back();\n              }\n        }\n      >\n        {\" \"}\n        Go Back\n      </div>\n    </div>\n  );\n};\n","import { FC, ReactElement, ReactNode, useEffect } from \"react\";\nimport { useLocal } from \"prasi-utils\";\n\nconst w = window as unknown as {\n  loadingIcon: string;\n  ContentLoading?: FC<{ alt?: any; note?: any }>;\n};\n\nexport const Loading: FC<{\n  children?: ReactNode;\n  className?: string;\n  show?: boolean;\n  backdrop?: boolean;\n  note?: ReactNode;\n  alt?: ReactElement;\n  pointer?: boolean;\n}> = ({ children, className, show, backdrop, note, alt, pointer }) => {\n  const local = useLocal(\n    {\n      icon: <div className=\"px-4 py-1\">Loading...</div>,\n      value: 0.111,\n      ival: null as any,\n    },\n    () => {}\n  );\n  useEffect(() => {\n    local.ival = setInterval(() => {\n      local.value += 0.1333;\n      if (local.value >= 1.3) {\n        local.value = 0;\n      }\n      local.render();\n    }, 200);\n    if (w.loadingIcon) {\n      local.icon = (\n        <img\n          alt=\"loading\"\n          src={w.loadingIcon}\n          className={css`\n            width: 42px;\n            height: 42px;\n          `}\n        />\n      );\n      local.render();\n    }\n    return () => {\n      clearInterval(local.ival);\n    };\n  }, []);\n\n  const CustomLoading = w.ContentLoading;\n  console.log()\n  return (\n    <>\n      {backdrop !== false && (\n        <div\n          className={cx(\n            \"flex items-center z-40 bg-white pointer-events-none\",\n            \"w-full h-full fixed transition-all duration-1000\",\n            typeof show !== \"undefined\"\n              ? show\n                ? \"opacity-50\"\n                : \"opacity-0\"\n              : \"opacity-50\"\n          )}\n          onContextMenuCapture={(e) => {\n            e.preventDefault();\n          }}\n        ></div>\n      )}\n      {children ? (\n        <div\n          onContextMenuCapture={(e) => {\n            e.preventDefault();\n          }}\n          className={cx(\n            \"flex flex-1 items-center justify-center z-40 transition-all\",\n            className\n              ? className\n              : backdrop !== false\n                ? \"w-full h-full fixed\"\n                : \"\",\n            typeof show !== \"undefined\" ? (show ? \"\" : \"hidden\") : \"\"\n          )}\n        >\n          <div className=\"flex items-center justify-center flex-col space-y-3 bg-white p-4 rounded-lg select-none\">\n            <div className=\"text-sm\">{children}</div>\n          </div>\n        </div>\n      ) : (\n        <div\n          className={cx(\n            \"flex flex-1 items-center justify-center z-40  transition-all\",\n            pointer !== true && \"pointer-events-none\",\n            className\n              ? className\n              : backdrop !== false\n                ? \"w-full h-full fixed\"\n                : \"\",\n            typeof show !== \"undefined\" ? (show ? \"\" : \"hidden\") : \"\"\n          )}\n        >\n          {CustomLoading ? (\n            <CustomLoading alt={alt} note={note} />\n          ) : (\n            <div\n              className={cx(\n                \"w-1/6 flex flex-col items-center justify-center\",\n                css`\n                  min-width: 30px;\n                  .pr-outer {\n                    background: rgba(0, 0, 0, 0.1) !important;\n                  }\n                `\n              )}\n            >\n              <div className=\"text-[10px] text-slate-400 whitespace-nowrap\">\n                {note}\n              </div>\n\n              <div className=\"pr-outer w-full h-[3px] flex items-stretch rounded-sm overflow-hidden\">\n                <div\n                  className={cx(\n                    \"bg-blue-800 transition-all duration-200 rounded-sm w-full\",\n                    css`\n                      transform: translate(${-100 + local.value * 200}%);\n                    `\n                  )}\n                ></div>\n              </div>\n              {alt}\n            </div>\n          )}\n        </div>\n      )}\n    </>\n  );\n};\n","import { VG } from \"../render/global\";\n\nexport const viLoad = (vi: VG, arg: { site_id: string; api_url: string }) => {\n  vi.status = \"loading\";\n  if (vi.on_status_changes) {\n    vi.on_status_changes(vi.status);\n  }\n  vi.site.id = arg.site_id;\n  vi.site.api_url = arg.api_url;\n\n  vi.status = \"ready\";\n  if (vi.on_status_changes) {\n    vi.on_status_changes(vi.status);\n  }\n};\n","import { IContent } from \"../../../utils/types/general\";\nimport { IItem } from \"../../../utils/types/item\";\nimport { IRoot } from \"../../../utils/types/root\";\nimport { IMeta } from \"../../ed/logic/ed-global\";\nimport { viParts } from \"./parts\";\n\ntype ViStatus = \"init\" | \"loading\" | \"ready\";\nexport const ViGlobal = {\n  ts: 0,\n  status: \"init\" as ViStatus,\n  meta: {} as Record<string, IMeta>,\n  entry: [] as string[],\n  tick: 0,\n  mode: \"desktop\" as \"mobile\" | \"desktop\",\n  site: {\n    id: \"\",\n    api_url: \"\",\n    api: null as any,\n    db: null as any,\n  },\n  site_url: null as unknown as URL,\n  script: {\n    init_local_effect: undefined as undefined | Record<string, boolean>,\n  },\n  visit: undefined as\n    | undefined\n    | ((meta: IMeta, parts: ReturnType<typeof viParts>) => void),\n  on_status_changes: undefined as void | ((status: ViStatus) => void),\n  layout: undefined as\n    | {\n        id: string;\n        meta: Record<string, IMeta>;\n        entry: string[];\n      }\n    | undefined,\n  page: {\n    cur: { id: \"\" },\n    navs: {} as Record<string, Set<string>>,\n    preload: [] as (() => void)[],\n  },\n  comp: {\n    load: (async () => {\n      return null as any;\n    }) as (comp_id: string) => Promise<null | IItem>,\n  },\n  on_preload: undefined as\n    | undefined\n    | ((arg: {\n        urls: string[];\n        opt?: {\n          on_load?: (\n            pages: {\n              id: string;\n              url: string;\n              root: IRoot;\n            }[],\n            walk: (\n              root: { root: IRoot }[],\n              visit: (item: IContent) => void | Promise<void>\n            ) => void\n          ) => void;\n        };\n      }) => Promise<void>),\n};\n\nexport type VG = typeof ViGlobal & { render: () => void };\n","import { useErrorBoundary, withErrorBoundary } from \"react-use-error-boundary\";\nimport { useLocal } from \"prasi-utils\";\nimport { IMeta } from \"../../ed/logic/ed-global\";\n\nexport const ErrorBox = withErrorBoundary(\n  ({\n    children,\n    meta,\n    id,\n    silent = true,\n  }: {\n    children: any;\n    meta?: IMeta;\n    id?: string;\n    silent?: boolean;\n  }) => {\n    const local = useLocal({ retrying: false, meta });\n    const [error, resetError] = useErrorBoundary((error, errorInfo) => {\n      if (silent !== true) console.error(error);\n    });\n\n    if (meta && local.meta !== meta) {\n      local.meta = meta;\n      setTimeout(resetError);\n    }\n\n    let _meta = meta;\n\n    if (error) {\n      return (\n        <div className=\"bg-red-100 border border-red-300 rounded-sm text-xs flex flex-col items-center\">\n          <div className=\"text-[10px] font-bold text-red-900 self-stretch px-1\">\n            ERROR {_meta?.item.name ? \"[\" + _meta.item.name + \"]:\" : \"\"}\n          </div>\n          <p className=\"border-b border-red-300 px-1 pb-1 min-w-[100px]\">\n            {!local.retrying ? <>{(error as any).message}</> : <>Retrying...</>}\n          </p>\n          <div className=\"p-1\">\n            <button\n              onClick={() => {\n                local.retrying = true;\n                local.render();\n\n                setTimeout(() => {\n                  local.retrying = false;\n                  local.render();\n                  resetError();\n                }, 100);\n              }}\n              className=\"bg-white border border-white hover:border-red-400 hover:bg-red-50 rounded px-2\"\n            >\n              Try again\n            </button>\n          </div>\n        </div>\n      );\n    }\n\n    return children;\n  }\n);\n","export const responsiveVal = <T>(\n  item: any,\n  key: string,\n  mode: \"desktop\" | \"mobile\" | undefined,\n  defaultVal: T\n): T => {\n  let value = item[key];\n\n  if (mode === \"desktop\" || !mode) {\n    if (!value && item.mobile && item.mobile[key]) {\n      value = item.mobile[key];\n    }\n  } else {\n    if (item.mobile && item.mobile[key]) {\n      value = item.mobile[key];\n    }\n  }\n\n  if (!value) {\n    value = defaultVal;\n  }\n  return value as T;\n};\n","import { responsiveVal } from \"../../nova/ed/panel/side/style/tools/responsive-val\";\nimport { MetaItem } from \"../types/meta\";\nimport { FNAdv } from \"../types/meta-fn\";\n\nexport const cssAdv = (\n  cur: { adv?: FNAdv; type: MetaItem[\"type\"] },\n  mode: \"mobile\" | \"desktop\"\n) => {\n  const adv = responsiveVal<FNAdv>(cur, \"adv\", mode, {});\n\n  if (typeof adv.css === \"string\") {\n    const hasCSS = adv.css.trim();\n    if (hasCSS) {\n      return cx(\n        css`\n          ${adv.css}\n        `,\n        mode\n      );\n    }\n  }\n  return \"\";\n};\n","import { responsiveVal } from \"../../nova/ed/panel/side/style/tools/responsive-val\";\nimport { MetaItem } from \"../types/meta\";\nimport { FNBackground } from \"../types/meta-fn\";\n\nexport const cssBackground = (\n  cur: { bg?: FNBackground; type: MetaItem[\"type\"] },\n  mode?: \"mobile\" | \"desktop\"\n) => {\n  const bg = responsiveVal<FNBackground>(cur, \"bg\", mode, {\n    size: \"contain\",\n    pos: \"center\",\n  });\n\n  let bgurl = `${serverurl}${bg.url}`;\n  if (bg && bg.url && bg.url.startsWith(\"http\")) {\n    bgurl = bg.url;\n  }\n\n  return cx(\n    `\n      background-repeat: no-repeat;\n    `,\n    bg.color &&\n      `\n        background-color: ${bg.color};\n      `,\n    bg.size &&\n      `\n        background-size: ${bg.size};\n      `,\n    bg.pos &&\n      `\n        background-position: ${bg.pos};\n      `\n  );\n};\n","import get from \"lodash.get\";\nimport { FNBorder } from \"../types/meta-fn\";\nimport { responsiveVal } from \"../../nova/ed/panel/side/style/tools/responsive-val\";\n\nexport const cssBorder = (\n  cur: { border?: FNBorder },\n  mode?: \"mobile\" | \"desktop\"\n) => {\n  const border = responsiveVal<FNBorder>(cur, \"border\", mode, {\n    style: \"solid\",\n    stroke: {},\n    rounded: {\n      tr: 0,\n      tl: 0,\n      bl: 0,\n      br: 0,\n    },\n    color: \"transparent\",\n  });\n  return cx(\n    pick(border, \"stroke.l\", \"border-left-width\"),\n    pick(border, \"stroke.r\", \"border-right-width\"),\n    pick(border, \"stroke.b\", \"border-bottom-width\"),\n    pick(border, \"stroke.t\", \"border-top-width\"),\n    pick(border, \"color\", \"border-color\", \"transparent\"),\n    pick(border, \"style\", \"border-style\", \"dashed\"),\n    pick(border, \"rounded.tl\", \"border-top-left-radius\"),\n    pick(border, \"rounded.tr\", \"border-top-right-radius\"),\n    pick(border, \"rounded.bl\", \"border-bottom-left-radius\"),\n    pick(border, \"rounded.br\", \"border-bottom-right-radius\")\n  );\n};\n\nconst pick = (obj: any, key: string, attr: string, notpx?: string) => {\n  const val = get(obj, key);\n  if (notpx) {\n    if (val) return `${attr}: ${val};`;\n    else return `${attr}: ${notpx};`;\n  } else if (val) return `${attr}: ${val}px;`;\n};\n","import { responsiveVal } from \"../../nova/ed/panel/side/style/tools/responsive-val\";\nimport { MetaItem } from \"../types/meta\";\nimport { FNDimension } from \"../types/meta-fn\";\n\nexport const cssDimension = (\n  cur: { dim?: FNDimension; type: MetaItem[\"type\"] },\n  mode?: \"mobile\" | \"desktop\",\n  editor?: boolean\n) => {\n  const dim = responsiveVal<FNDimension>(cur, \"dim\", mode, {\n    h: \"fit\",\n    w: \"fit\",\n  });\n\n  if (dim.w === \"full\" && dim.h === \"full\") {\n    return `\n      width:100%;\n      height:100%;\n      flex:1;\n    `;\n  }\n\n  return cx(\n    dim.w === \"fit\" &&\n      `\n        & > .txt-box > * {\n          white-space: nowrap !important;\n        }\n      `,\n    dim.w === \"full\" &&\n      `\n        width: 100%;\n      `,\n    dim.w &&\n      typeof dim.w === \"number\" &&\n      dim.w >= 0 &&\n      `\n        width: ${dim.w}${dim.wUnit || \"px\"};\n        overflow-x: clip;\n      `,\n    dim.h === \"full\" &&\n      `\n        height: ${\n          editor\n            ? \"100%\"\n            : \"100\" +\n              (cur.type === \"section\" ? (mode === \"mobile\" ? \"vh\" : \"vh\") : \"%\")\n        };\n        margin-bottom: auto;\n      `,\n\n    dim.h &&\n      typeof dim.h === \"number\" &&\n      dim.h >= 0 &&\n      `\n        height: ${dim.h}${dim.hUnit || \"px\"};\n        overflow-y: clip;\n      `\n  );\n};\n","import { IContent } from \"../types/general\";\n\nexport const cssEditor = ({\n  item,\n  hover,\n  active,\n}: {\n  item: IContent;\n  hover?: boolean;\n  active?: boolean;\n}) => {\n  return cx(\n    hover &&\n      css`\n        & {\n          box-shadow: inset 0 0 0px 3px #bae3fd;\n          > img {\n            opacity: 0.6;\n          }\n        }\n      `,\n    active &&\n      css`\n        box-shadow: inset 0 0 0px 2px #009cff !important;\n        > img {\n          opacity: 0.6;\n        }\n      `\n  );\n};\n","import { responsiveVal } from \"../../nova/ed/panel/side/style/tools/responsive-val\";\nimport { MetaItem } from \"../types/meta\";\nimport { FNFont } from \"../types/meta-fn\";\n\nexport const glbFont = window as unknown as {\n  defaultFont: string;\n  loadedFonts: string[];\n};\n\nexport const cssFont = (\n  cur: { font?: FNFont; type: MetaItem[\"type\"] },\n  mode?: \"mobile\" | \"desktop\"\n) => {\n  const font = responsiveVal<FNFont>(cur, \"font\", mode, {});\n\n  if (font.family) {\n    if (!glbFont.loadedFonts) glbFont.loadedFonts = [];\n    const weight = `:wght@${[300, 400, 500, 600].join(\";\")}`;\n    const fontName = font.family.replace(/ /g, \"+\");\n\n    if (glbFont.loadedFonts.indexOf(font.family) < 0) {\n      glbFont.loadedFonts.push(font.family);\n      const doc = document;\n      const _href = `https://fonts.googleapis.com/css2?family=${fontName}${weight}&display=swap`;\n      if (!doc.querySelector(`link[href=\"${_href}]`)) {\n        const link = doc.createElement(\"link\");\n        link.type = \"text/css\";\n        link.rel = \"stylesheet\";\n        link.crossOrigin = \"anonymous\";\n        link.href = _href;\n        doc.head.appendChild(link);\n      }\n    }\n  }\n\n  if (!font.family && glbFont.defaultFont) {\n    font.family = glbFont.defaultFont;\n  }\n\n  const res = cx(\n    font.color &&\n      `\n        color: ${font.color};\n      `,\n    font.whitespace === \"whitespace-normal\" &&\n      `\n      word-break: break-word;\n    `,\n    font.whitespace === \"whitespace-nowrap\" &&\n      `\n        white-space: nowrap;\n      `,\n    font.color &&\n      `\n        color: ${font.color};\n      `,\n    `\n      text-align: ${font.align ? font.align : \"left\"};\n    `,\n    font.size &&\n      `\n        font-size: ${font.size || 15}px;\n      `,\n    font.height &&\n      `\n        line-height: ${font.height === \"auto\" ? \"normal\" : `${font.height}%`};\n      `,\n    font.family &&\n      `\n        font-family: ${font.family};\n      `\n  );\n\n  return res;\n};\n","import { responsiveVal } from \"../../nova/ed/panel/side/style/tools/responsive-val\";\nimport { FNLayout } from \"../types/meta-fn\";\n\nexport const cssLayout = (\n  cur: { layout?: FNLayout },\n  mode?: \"mobile\" | \"desktop\"\n) => {\n  const result: string[] = [];\n  let layout = responsiveVal<FNLayout>(cur, \"layout\", mode, {\n    dir: \"col\",\n    align: \"top-left\",\n    gap: 0,\n    wrap: undefined,\n  });\n\n  if (layout) {\n    if (layout.wrap) {\n      result.push(\n        layout.wrap === \"flex-wrap\" ? \"flex-wrap: wrap;\" : \"flex-wrap: nowrap;\"\n      );\n    }\n    if (layout.dir.startsWith(\"col\")) {\n      if (layout.dir === \"col\") {\n        result.push(\"flex-direction: column;\");\n      } else if (layout.dir === \"col-reverse\") {\n        result.push(\"flex-direction: column-reverse;\");\n      }\n      if (layout.gap === \"auto\") {\n        if (layout.align === \"left\")\n          result.push(\"align-items:start; justify-content: space-between;\");\n        if (layout.align === \"center\")\n          result.push(\"align-items:center; justify-content: space-between;\");\n        if (layout.align === \"right\")\n          result.push(\"align-items:end; justify-content: space-between;\");\n      } else {\n        result.push(`gap: ${layout.gap}px;`);\n\n        if (layout.align === \"top-left\")\n          result.push(\"align-items:start; justify-content: start;\");\n        if (layout.align === \"top-center\")\n          result.push(\"align-items:center; justify-content: start;\");\n        if (layout.align === \"top-right\")\n          result.push(\"align-items:end; justify-content: start;\");\n\n        if (layout.align === \"left\")\n          result.push(\"align-items:start; justify-content: center;\");\n        if (layout.align === \"center\")\n          result.push(\"align-items:center; justify-content: center;\");\n        if (layout.align === \"right\")\n          result.push(\"align-items:end; justify-content: center;\");\n\n        if (layout.align === \"bottom-left\")\n          result.push(\"align-items:start; justify-content: end;\");\n        if (layout.align === \"bottom-center\")\n          result.push(\"align-items:center; justify-content: end;\");\n        if (layout.align === \"bottom-right\")\n          result.push(\"align-items:end; justify-content: end;\");\n      }\n    } else {\n      if (layout.dir === \"row\") {\n        result.push(\"flex-direction: row;\");\n      } else if (layout.dir === \"row-reverse\") {\n        result.push(\"flex-direction: row-reverse;\");\n      }\n\n      if (layout.gap === \"auto\") {\n        if (layout.align === \"top\")\n          result.push(\"align-items:start; justify-content: space-between;\");\n        if (layout.align === \"center\")\n          result.push(\"align-items:center; justify-content: space-between;\");\n        if (layout.align === \"bottom\")\n          result.push(\"align-items:end; justify-content: space-between;\");\n      } else {\n        result.push(\n          `\n            gap: ${layout.gap}px;\n          `\n        );\n\n        if (layout.align === \"top-left\")\n          result.push(\"align-items:start; justify-content: start;\");\n        if (layout.align === \"top-center\")\n          result.push(\"align-items:start; justify-content: center;\");\n        if (layout.align === \"top-right\")\n          result.push(\"align-items:start; justify-content: end;\");\n\n        if (layout.align === \"left\")\n          result.push(\"align-items:center; justify-content: start;\");\n        if (layout.align === \"center\")\n          result.push(\"align-items:center; justify-content: center;\");\n        if (layout.align === \"right\")\n          result.push(\"align-items:center; justify-content: end;\");\n\n        if (layout.align === \"bottom-left\")\n          result.push(\"align-items:end; justify-content: start;\");\n        if (layout.align === \"bottom-center\")\n          result.push(\"align-items:end; justify-content: center;\");\n        if (layout.align === \"bottom-right\")\n          result.push(\"align-items:end; justify-content: end;\");\n      }\n    }\n  } else {\n    return \"flex-direction:column; align-items:start; justify-content: start;\";\n  }\n  return result.join(\"\\n\\t\").trim();\n};\n","import { responsiveVal } from \"../../nova/ed/panel/side/style/tools/responsive-val\";\nimport { FNPadding } from \"../types/meta-fn\";\n\nexport const cssPadding = (\n  cur: { padding?: FNPadding },\n  mode?: \"mobile\" | \"desktop\"\n) => {\n  const padding = responsiveVal<FNPadding>(cur, \"padding\", mode, {\n    l: 0,\n    b: 0,\n    t: 0,\n    r: 0,\n  });\n\n  return cx(\n    padding.l !== undefined &&\n      `\n        padding-left: ${padding.l}px;\n      `,\n    padding.r !== undefined &&\n      `\n        padding-right: ${padding.r}px;\n      `,\n    padding.b !== undefined &&\n      `\n        padding-bottom: ${padding.b}px;\n      `,\n    padding.t !== undefined &&\n      `\n        padding-top: ${padding.t}px; \n      `\n  );\n};\n","import { IItem } from \"../types/item\";\nimport { ISection } from \"../types/section\";\nimport { IText } from \"../types/text\";\nimport { cssAdv } from \"./advanced\";\nimport { cssBackground } from \"./background\";\nimport { cssBorder } from \"./border\";\nimport { cssDimension } from \"./dimension\";\nimport { cssEditor } from \"./editor\";\nimport { cssFont } from \"./font\";\nimport { cssLayout } from \"./layout\";\nimport { cssPadding } from \"./padding\";\n\nexport const produceCSS = (\n  item: ISection | IItem | IText,\n  arg: {\n    mode: \"mobile\" | \"desktop\";\n    hover?: boolean;\n    active?: boolean;\n    editor?: boolean;\n  }\n): string => {\n  try {\n    return cx([\n      item.id ? `s-${item.id}` : \"\",\n      css`\n        display: flex;\n        position: relative;\n        user-select: none;\n        ${cssLayout(item, arg.mode)}\n        ${cssPadding(item, arg.mode)}\n        ${cssDimension(item, arg.mode, arg?.editor)}\n        ${cssBorder(item, arg.mode)}\n        ${cssBackground(item, arg.mode)}\n        ${cssFont(item, arg.mode)}\n      `,\n      (arg?.hover || arg?.active) &&\n        cssEditor({ item, hover: arg?.hover, active: arg?.active }),\n      cssAdv(item, arg.mode),\n    ]);\n  } catch (e) {\n    console.log(e);\n  }\n  return cx([]);\n};\n","import { produceCSS } from \"../../../utils/css/gen\";\nimport { IContent } from \"../../../utils/types/general\";\nimport { IItem } from \"../../../utils/types/item\";\nimport { IMeta } from \"../../ed/logic/ed-global\";\nimport { ViRender } from \"./render\";\n\nexport type ViParts = {\n  mode: \"mobile\" | \"desktop\";\n  hover?: boolean;\n  active?: boolean;\n};\n\ntype PROPS = React.DetailedHTMLProps<\n  React.HTMLAttributes<HTMLDivElement>,\n  HTMLDivElement\n>;\n\nexport const viParts = (\n  vi: {\n    mode: \"desktop\" | \"mobile\";\n    meta: Record<string, IMeta>;\n    layout?: {\n      id: string;\n      meta: Record<string, IMeta>;\n      entry: string[];\n    };\n  },\n  meta: IMeta,\n  is_layout: boolean,\n  passprop: any,\n  depth: number\n) => {\n  const item = meta.item;\n\n  let inherit = undefined;\n  if (item.component?.style) {\n    inherit = {\n      style: item.component.style,\n      className: produceCSS(item.component.style, { mode: vi.mode }),\n    };\n  }\n\n  const props: PROPS & { inherit?: { style: IItem; className: string } } = {\n    className: produceCSS(item, {\n      mode: vi.mode,\n    }),\n    inherit,\n  };\n\n  let text_props: PROPS = {};\n\n  const childs = meta.item.childs;\n  let children = undefined;\n\n  if ((meta.item as IContent).type === \"text\") {\n    children = null;\n    props.dangerouslySetInnerHTML = { __html: meta.item.html || \"\" };\n  } else {\n    children =\n      Array.isArray(childs) &&\n      childs?.map((item) => {\n        if (!item) return null;\n        const { id } = item;\n\n        let meta = is_layout ? vi.layout?.meta[id] : vi.meta[id];\n\n        if (!meta) {\n          if (item.type === \"item\" && item.component?.id) {\n            console.error(\n              `Warning component ${item.name} - ${item.component.id} failed to load.`\n            );\n          }\n          return null;\n        }\n\n\n        return (\n          <ViRender\n            key={id}\n            meta={meta}\n            is_layout={is_layout}\n            passprop={{ ...passprop }}\n            depth={depth + 1}\n          />\n        );\n      });\n  }\n\n  props.children = children;\n\n  if (meta.item.adv?.html) {\n    delete props.children;\n    props.dangerouslySetInnerHTML = { __html: meta.item.adv?.html };\n  } else if (meta.item.adv?.js && !meta.item.adv.js.includes(\"children\")) {\n    delete props.children;\n    delete props.dangerouslySetInnerHTML;\n  }\n\n  return {\n    props,\n    text_props,\n  };\n};\n","import { NodeModel } from \"@minoru/react-dnd-treeview\";\nimport { page } from \"prasi-db\";\nimport { deepClone } from \"prasi-utils\";\nimport { clientStartSync } from \"../../../utils/sync/client\";\nimport { IItem } from \"../../../utils/types/item\";\nimport { DCode, DComp, DPage, IRoot } from \"../../../utils/types/root\";\nimport { GenMetaP, IMeta as LogicMeta } from \"../../vi/utils/types\";\nimport { createRouter } from \"radix3\";\nimport { FEntry } from \"../panel/file/type\";\nexport type IMeta = LogicMeta;\n\nexport const EmptySite = {\n  id: \"\",\n  name: \"\",\n  domain: \"\",\n  config: { api_url: \"\" },\n  deploy_name: \"\",\n  js: \"\",\n  js_compiled: \"\",\n  responsive: \"\" as \"desktop-only\" | \"mobile-only\" | \"responsive\",\n  layout: {\n    id: \"--\",\n    meta: undefined as void | Record<string, IMeta>,\n    entry: [] as string[],\n  },\n};\n\nexport type ESite = typeof EmptySite;\nexport type EPage = typeof EmptyPage;\nexport type EComp = typeof EmptyComp;\nexport type PropFieldKind =\n  | \"onChange\"\n  | \"visible\"\n  | \"gen\"\n  | \"value\"\n  | \"option\"\n  | \"typings\";\nexport type ISingleScope = {\n  p: string[];\n  n: string;\n  s: any;\n};\nexport type IScope = Record<string, ISingleScope>;\n\nexport type IScopeComp = Record<\n  string,\n  {\n    id: string;\n    name: string;\n    snapshot: Uint8Array;\n    scope: IScope;\n  }\n>;\nexport const EmptyPage = {\n  id: \"\",\n  name: \"\",\n  url: \"\",\n  snapshot: null as null | Uint8Array,\n  comps: {} as Record<string, EComp>,\n};\n\nconst EmptyComp = {\n  id: \"\",\n  snapshot: null as null | Uint8Array,\n};\n\nconst target = {\n  active_id: false as any,\n  comp_id: false as any,\n  instance_comp_id: false as any,\n  instance_item_id: false as any,\n};\n\nexport const active = {\n  should_render_main: true,\n  hover: { id: \"\", tree: false },\n  scope: {} as any,\n  script_nav: {\n    list: [] as {\n      item_id: string;\n      comp_id?: string;\n      instance?: { item_id: string; comp_id?: string };\n    }[],\n    idx: -1,\n  },\n  text: { id: \"\", content: \"\", timeout: null as any, el: null as any },\n  get item_id() {\n    if (target.active_id === false) {\n      target.active_id = localStorage.getItem(\"prasi-active-id\") || \"\";\n    }\n    return target.active_id || \"\";\n  },\n  set item_id(val: string) {\n    localStorage.setItem(\"prasi-active-id\", val || \"\");\n    target.active_id = val || \"\";\n  },\n  get comp_id() {\n    if (target.comp_id === false) {\n      target.comp_id = localStorage.getItem(\"prasi-comp-id\") || \"\";\n    }\n    return target.comp_id || \"\";\n  },\n  set comp_id(val: string) {\n    localStorage.setItem(\"prasi-comp-id\", val || \"\");\n    target.comp_id = val || \"\";\n  },\n  instance: {\n    get comp_id() {\n      if (target.instance_comp_id === false) {\n        target.instance_comp_id =\n          localStorage.getItem(\"prasi-instance-comp-id\") || \"\";\n      }\n      return target.instance_comp_id || \"\";\n    },\n    set comp_id(val: string) {\n      localStorage.setItem(\"prasi-instance-comp-id\", val || \"\");\n      target.instance_comp_id = val || \"\";\n    },\n    get item_id() {\n      if (target.instance_item_id === false) {\n        target.instance_item_id =\n          localStorage.getItem(\"prasi-instance-item-id\") || \"\";\n      }\n      return target.instance_item_id || \"\";\n    },\n    set item_id(val: string) {\n      localStorage.setItem(\"prasi-instance-item-id\", val || \"\");\n      target.instance_item_id = val || \"\";\n    },\n  },\n};\n\nexport type CompListItem = {\n  comp: EComp;\n  doc: DComp;\n  tree: NodeModel<IMeta>[];\n  meta: Record<string, IMeta>;\n  on_update: (bin: Uint8Array, origin: any) => Promise<void>;\n};\n\nexport const EDGlobal = {\n  mode: \"\" as \"desktop\" | \"mobile\",\n  user: { id: \"\", username: \"\", client_id: \"\" },\n  clients: {} as Record<string, { id: string; username: string }>,\n  status: \"init\" as\n    | \"init\"\n    | \"load-site\"\n    | \"reload\"\n    | \"site-not-found\"\n    | \"page-not-found\"\n    | \"ready\"\n    | \"no-site\",\n  preview: {\n    url_cache: new Set<string>(),\n    route_cache: createRouter<{ url: string; id: string }>(),\n    page_cache: {} as Record<string, { root: IRoot; url: string }>,\n    meta_cache: {} as Record<\n      string,\n      { entry: string[]; meta: Record<string, IMeta>; url: string }\n    >,\n  },\n  sync: undefined as undefined | Awaited<ReturnType<typeof clientStartSync>>,\n  site: deepClone(EmptySite),\n  site_tstamp: Date.now(),\n  site_exports: {} as Record<string, any>,\n  site_dts: \"\",\n  site_dts_entry: {} as any,\n  prisma_ext: \"\",\n  script: {\n    site_types: {} as Record<string, string>,\n    loaded: false,\n    do_edit: async (newval: string, all?: boolean) => {},\n    db: null as any,\n    api: null as any,\n    init_local_effect: {} as Record<string, boolean>,\n  },\n  page: {\n    history: {\n      id: \"\",\n      show: false,\n    },\n    root_id: \"root\",\n    cur: EmptyPage,\n    doc: null as null | DPage,\n    list: {} as Record<\n      string,\n      {\n        page: EPage;\n        doc: DPage;\n        on_update?: (bin: Uint8Array, origin: any) => Promise<void>;\n        update_timeout: any;\n      }\n    >,\n    building: false,\n    meta: {} as Record<string, IMeta>,\n    entry: [] as string[],\n    tree: [] as NodeModel<IMeta>[],\n    render: () => {},\n  },\n  comp: {\n    doc: null as null | DComp,\n    item: null as null | IItem,\n    loaded: {} as GenMetaP[\"comps\"],\n    list: {} as Record<string, CompListItem>,\n    group: {} as Record<string, any>,\n  },\n  code: {} as Record<string, { doc: null | DCode }>,\n  global_prop: [] as string[],\n  ui: {\n    build: { status: \"ready\" as \"ready\" | \"loading\" | \"error\" },\n    monaco: null as any,\n    comp_editable: localStorage.getItem(\"prasi-comp-editable\") === \"yes\",\n    zoom: localStorage.zoom || \"100%\",\n    side: { prop: true },\n    layout: {\n      left: parseInt(localStorage.getItem(\"prasi-layout-left\") || \"250\"),\n      right: parseInt(localStorage.getItem(\"prasi-layout-right\") || \"250\"),\n    },\n    prevent_indent_hook: false,\n    syncing: false,\n    tree: {\n      item_loading: [] as string[],\n      search: \"\",\n      search_ref: null as null | HTMLInputElement,\n      search_mode: {\n        Name: true,\n        JS: false,\n        HTML: false,\n        CSS: false,\n      },\n      rename_id: \"\",\n      open_all: false,\n      open: {} as Record<string, string[]>,\n    },\n    popup: {\n      file: {\n        enabled: false,\n        open: false,\n        picker: {\n          value: \"\",\n          on_pick: false as boolean | ((file: string) => void | Promise<void>),\n          multi: false,\n        },\n        path: \"/\",\n        expanded: JSON.parse(\n          localStorage.getItem(\"panel-file-expanded\") || \"{}\"\n        ) as Record<string, string[]>,\n        entry: {} as Record<string, FEntry[]>,\n        selected: new Set<string>(),\n\n        action: null as null | {\n          label: string;\n          submit: () => void | Promise<void>;\n        },\n\n        file_renaming: \"\",\n        file_ctx_menu_event: null as null | React.MouseEvent<\n          HTMLElement,\n          MouseEvent\n        >,\n\n        tree: [] as NodeModel<FEntry>[],\n        tree_renaming: \"\",\n        tree_ctx_path: \"\",\n        tree_ctx_menu_event: null as null | React.MouseEvent<\n          HTMLElement,\n          MouseEvent\n        >,\n\n        preview: true,\n        upload: {\n          started: false,\n          progress: {} as Record<string, number>,\n        },\n      },\n      code: {\n        init: false,\n        open: false,\n        name: \"site\",\n        log: \"\",\n        loading: false,\n        rebuilding: false,\n        startup_status: \"init\" as\n          | \"init\"\n          | \"loading\"\n          | \"disabled\"\n          | \"stopped\"\n          | \"running\",\n        error: false,\n        show_log: false,\n        list: {} as Record<string, string>,\n      },\n      page: {\n        open: null as null | ((page_id: string) => void),\n        form: null as null | Partial<page>,\n      },\n      script: {\n        open: false,\n        mode: \"js\" as \"flow\" | \"js\" | \"css\" | \"html\",\n        lastMode: \"js\" as \"flow\" | \"js\" | \"css\" | \"html\",\n        type: \"item\" as \"item\" | \"prop-master\" | \"prop-instance\" | \"comp-types\",\n        prop_kind: \"\" as PropFieldKind,\n        prop_name: \"\",\n        on_close: () => {},\n        typings: { status: \"ok\" as \"ok\" | \"loading\" | \"error\", err_msg: \"\" },\n        wb_render: () => {},\n      },\n      site: null as null | ((site_id: string) => void | Promise<void>),\n      site_form: null as null | {\n        group_id: string;\n        id: string;\n        name?: string;\n        domain?: string;\n        responsive?: string;\n      },\n      comp: {\n        preview_id: \"\",\n        open: null as null | ((comp_id: string) => void | Promise<void>),\n        import: false,\n      },\n      comp_group: null as null | {\n        mouse_event: React.MouseEvent<HTMLElement, MouseEvent>;\n        on_pick?: (group_id: string) => void | Promise<void>;\n        on_close?: () => void | Promise<void>;\n      },\n      api: { open: false },\n    },\n  },\n};\n\nexport type PG = typeof EDGlobal & { render: () => void };\n","export const viScriptArg = (vi: {\n  mode: \"mobile\" | \"desktop\";\n  site: { db: any; api: any };\n}) => ({\n  isMobile: vi.mode === \"mobile\",\n  isDesktop: vi.mode === \"desktop\",\n  isEditor: location.pathname.startsWith(\"/ed/\"),\n});\n","import type { transform } from \"sucrase\";\n\nconst imported = {\n  transform: null as null | typeof transform,\n};\n\nexport const codeBuild = async (\n  codes: Record<string, string>,\n  filePath?: string\n) => {\n  if (!imported.transform) {\n    imported.transform = (await import(\"sucrase\")).transform;\n  }\n\n  const result = {} as Record<string, string>;\n  for (const [k, v] of Object.entries(codes)) {\n    result[k] = imported.transform(v, {\n      transforms: [\"typescript\", \"imports\", \"jsx\"],\n      preserveDynamicImport: true,\n      disableESTransforms: true,\n      filePath: filePath,\n    }).code;\n\n    const removes = [`\"use strict\";`];\n    for (const r of removes) {\n      if (result[k].startsWith(r)) {\n        result[k] = result[k].substring(r.length).trim();\n      }\n    }\n  }\n  return result;\n};\n","import { page as dbpage } from \"prasi-db\";\nimport { TypedDoc, TypedMap } from \"yjs-types\";\nimport { IItem, MItem } from \"./item\";\nimport { IRoot, MRoot } from \"./root\";\nimport { ISection, MSection } from \"./section\";\nimport { IText, MText } from \"./text\";\nexport type PageProps = {\n  pathname: string;\n  domain: string;\n  params: any;\n};\n\nexport type PrasiAPI = {\n  apiEntry: any;\n  prismaTypes?: {\n    \"prisma.d.ts\": string;\n    \"runtime/library.d.ts\": string;\n    \"runtime/index.d.ts\": string;\n  };\n  apiTypes?: string;\n};\n\nexport const w = window as unknown as {\n  isEditor: boolean;\n  isMobile: boolean;\n  basehost?: string;\n  basepath: string;\n  navigateOverride: (s: string) => string;\n  isDesktop: boolean;\n  prasiApi: Record<string, PrasiAPI>;\n  prasiContext: {\n    render: () => void;\n    renderEditor?: () => void;\n    afterEditorRender?: () => void;\n  };\n  loadedFonts: string[];\n  prasiApiDbPull: boolean;\n  mobile?: any;\n  params: any;\n  editorGlbDefault: string;\n  ts: number;\n  serverurl: string;\n  apiurl: string;\n  _api: any;\n  _db: any;\n  offline: boolean;\n  sync_too_long: boolean;\n  editorRender?: () => void;\n  debug: {\n    on: any;\n    off: any;\n  };\n  pointer_active: boolean\n};\n\nexport type Page = {\n  id: string;\n  content_tree: IRoot;\n  js: string | null;\n  js_compiled: string | null;\n};\nexport type MPage = TypedDoc<{\n  map: TypedMap<\n    Omit<dbpage, \"content_tree\" | \"updated_at\"> & {\n      content_tree: MRoot;\n      updated_at: string;\n    }\n  >;\n}>;\n\nexport type IContent = ISection | IItem | IText;\nexport type MContent = MItem;\n\nexport type RenderContentProp = Partial<{\n  active: IContent | null;\n  hover: IContent | null;\n  update: (updateID: string, name: string, newState: IRoot) => void;\n  onHover: (e: React.MouseEvent, item: IContent) => Promise<void>;\n  onOut: (e: React.MouseEvent, item: IContent) => Promise<void>;\n  onClick: (e: React.MouseEvent, item: IContent) => Promise<void>;\n  isEditor: boolean;\n  setContent: (item: IContent) => Promise<void>;\n  _onlyChildren?: true;\n}>;\n\nexport type ERenderProp<ITEM> = {\n  item: ITEM;\n};\n","import { createStore } from \"idb-keyval\";\nimport { VG } from \"../global\";\n\nconst store = createStore(`prasi-cache`, `prasi-cache-store`);\nexport const nav = { timeout: null as any, store };\n\nexport const extractNavigate = (\n  vi: { page: VG[\"page\"]; on_nav_loaded?: VG[\"on_preload\"] },\n  str: string\n) => {\n  const found_nav = [\n    ...findBetween(str, `navigate(`, `)`),\n    ...findBetween(str, `href = `, `;`),\n  ];\n\n  const page_id = vi.page.cur.id;\n  if (!vi.page.navs[page_id]) {\n    vi.page.navs[page_id] = new Set();\n  }\n\n  for (const url of found_nav) {\n    vi.page.navs[page_id].add(url);\n  }\n\n  clearTimeout(nav.timeout);\n  nav.timeout = setTimeout(() => {\n    if (vi.on_nav_loaded) {\n      vi.on_nav_loaded({\n        urls: Array.from(vi.page.navs[page_id]),\n      });\n    }\n  }, 100);\n};\n\nconst findBetween = (text: string, opener: string, closer: string) => {\n  let i = 0;\n  let last = 0;\n  const founds: string[] = [];\n  while (true) {\n    const startIndex = text.indexOf(opener, i);\n    last = i;\n    if (startIndex >= 0) {\n      const char = text[startIndex + opener.length];\n      if (char === '\"' || char === \"'\" || char === \"`\") {\n        const end = text.indexOf(\n          `${char}${closer}`,\n          startIndex + opener.length + 1\n        );\n        const found = text.substring(startIndex + opener.length + 1, end);\n        i = end + 2 + closer.length;\n        founds.push(found);\n      }\n    }\n\n    if (last === i) {\n      break;\n    }\n  }\n  return founds;\n};\n","import get from \"lodash.get\";\nimport { ReactNode, isValidElement, useState } from \"react\";\nimport { IMeta } from \"../../../ed/logic/ed-global\";\nimport { VG } from \"../global\";\nimport { ViRender } from \"../render\";\n\nexport const createViPassProp = (\n  vi: { meta: VG[\"meta\"]; render?: () => void; comp: VG[\"comp\"] },\n  is_layout: boolean,\n  meta: IMeta,\n  passprop: any,\n  depth: number\n) => {\n  return (\n    arg: Record<string, any> & { children: ReactNode; internal_key: any }\n  ) => {\n    const [_, render] = useState({});\n    const internal_key = arg.idx || arg.internal_key;\n\n    if (!meta.item.script) {\n      meta.item.script = {};\n    }\n\n    let script = meta.item.script;\n    if (typeof internal_key !== \"undefined\") {\n      if (!meta.item.script_keyed) {\n        meta.item.script_keyed = {};\n      }\n\n      if (!meta.item.script_keyed[internal_key]) {\n        meta.item.script_keyed[internal_key] = {};\n      }\n      script = meta.item.script_keyed[internal_key] as any;\n    }\n\n    if (!script.passprop) {\n      script.passprop = {};\n    }\n\n    const filtered_args: any = {};\n    let is_changed = false;\n    for (const [k, v] of Object.entries(arg)) {\n      if (![\"children\", \"key\"].includes(k)) {\n        is_changed = true;\n        filtered_args[k] = v;\n      }\n    }\n\n    let _pass = { ...passprop, ...filtered_args };\n\n    if (typeof internal_key !== \"undefined\") {\n      if (typeof script.passprop.internal_key === \"undefined\") {\n        script.passprop = _pass;\n      } else if (internal_key === script.passprop.internal_key) {\n        script.passprop = _pass;\n      }\n\n      _pass = script.passprop;\n    }\n\n    meta.editor_props = _pass;\n\n    if (\n      !Array.isArray(arg.children) &&\n      isValidElement(arg.children) &&\n      typeof arg.children === \"object\"\n    ) {\n      const children = get(\n        arg.children,\n        \"props.meta.item.component.props.child.content.childs\"\n      ) as unknown as any[];\n\n      if (Array.isArray(children)) {\n        let is_meta = true;\n        for (const c of children) {\n          if (!(!isValidElement(c) && typeof c === \"object\")) {\n            is_meta = false;\n          }\n        }\n\n        if (is_meta) {\n          return children.map((item) => {\n            let cmeta = vi.meta[item.id];\n\n            if (!cmeta) {\n              vi.meta[item.id] = { item };\n              cmeta = vi.meta[item.id];\n            }\n\n            if (cmeta) {\n              if (Object.keys(cmeta.item).length <= 3) {\n                if (cmeta.mitem) {\n                  const citem = { ...cmeta.item };\n                  const ref_item = cmeta.mitem.toJSON() as any;\n                  cmeta.item = { ...ref_item, ...citem };\n                }\n              }\n\n              return (\n                <ViRender\n                  key={item.id}\n                  is_layout={is_layout}\n                  meta={cmeta}\n                  passprop={_pass}\n                  parent_key={arg.internal_key}\n                  depth={depth}\n                />\n              );\n            }\n            return null;\n          });\n        }\n      }\n    }\n\n    if (\n      !Array.isArray(arg.children) &&\n      !isValidElement(arg.children) &&\n      typeof arg.children === \"object\"\n    ) {\n      const child_id = (arg.children as any).id;\n      if (child_id) {\n        let meta = vi.meta[child_id];\n\n        if (!meta) {\n          vi.meta[child_id] = { item: arg.children as any };\n          meta = vi.meta[child_id];\n\n          const comp_id = meta.item.component?.id;\n          if (comp_id) {\n            vi.comp.load(comp_id).then((comp) => {\n              if (comp) {\n                for (const [k, v] of Object.entries(comp)) {\n                  const item = meta.item as any;\n                  if (!item[k]) item[k] = v;\n                }\n                const props = meta.item.component?.props as any;\n                for (const [k, v] of Object.entries(\n                  comp.component?.props || {}\n                )) {\n                  if (!props[k]) props[k] = v;\n                }\n                render({});\n              }\n            });\n          }\n        }\n\n        return (\n          <ViRender\n            is_layout={is_layout}\n            meta={meta}\n            passprop={_pass}\n            parent_key={arg.internal_key}\n            depth={depth}\n          />\n        );\n      }\n    }\n\n    const result = modifyChild(\n      arg,\n      _pass,\n      internal_key ? { parent_key: internal_key } : undefined\n    );\n    return result;\n  };\n};\n\nexport const modifyChild = (arg: any, passprop?: any, add_props?: any) => {\n  let prop: any = {};\n  if (Array.isArray(arg)) {\n    prop.children = arg;\n  } else {\n    prop = arg;\n  }\n\n  if (Array.isArray(prop.children)) {\n    if (prop.children.length === 1) {\n      return modify(prop.children[0], prop, passprop, add_props);\n    }\n    const childs = [];\n    for (const child of prop.children) {\n      childs.push(modify(child, prop, passprop, add_props));\n    }\n    return childs;\n  }\n\n  return modify(prop.children, prop, passprop, add_props);\n};\n\nconst modify = (\n  el: ReactNode | ReactNode[],\n  arg: any,\n  passprop?: any,\n  add_props?: any\n): ReactNode | ReactNode[] => {\n  if (isValidElement(el)) {\n    const passarg = { ...arg };\n    delete passarg.children;\n\n    const result = {\n      ...el,\n      props: {\n        ...el.props,\n        ...add_props,\n        passprop: { ...passprop, ...passarg },\n      },\n    };\n\n    return result;\n  } else if (Array.isArray(el)) {\n    return modifyChild(el, passprop, add_props);\n  }\n  return el;\n};\n","import { ReactNode, useEffect, useRef, useState } from \"react\";\nimport { IMeta } from \"../../../ed/logic/ed-global\";\nimport { VG } from \"../global\";\nimport { modifyChild } from \"./passprop\";\nimport { deepClone } from \"prasi-utils\";\nimport { w } from \"./eval-prop\";\n\nexport const local_cached_value = {} as Record<\n  string,\n  { mounted: boolean; value: any }\n>;\n\nexport const createViLocal = (\n  vi: {\n    page: { cur: { id: string } };\n    layout: VG[\"layout\"];\n    site: { db: any; api: any };\n    meta: Record<string, IMeta>;\n    script?: {\n      init_local_effect: any;\n    };\n  },\n  is_layout: boolean,\n  meta: IMeta\n) => {\n  return <T extends Record<string, any>>(arg: {\n    children: ReactNode;\n    name: string;\n    value: T;\n    hook?: (local: T) => void;\n    effect?: (local: T) => void | Promise<void>;\n    parent_key?: any;\n    deps?: any[];\n  }) => {\n    const isEditor =\n      ([\"prasi.avolut.com\"].includes(location.hostname) ||\n        location.host === \"localhost:4550\") &&\n      location.pathname.startsWith(\"/ed/\");\n    let id = meta.item.id;\n\n    const { children, parent_key } = arg;\n    const init_local_effect = vi.script?.init_local_effect;\n    const metas = is_layout ? vi.layout?.meta : vi.meta;\n\n    const curid = vi.page.cur.id + \"~\" + id;\n    if (!local_cached_value[curid]) {\n      local_cached_value[curid] = { mounted: true, value: arg.value };\n    } else if (!local_cached_value[curid].mounted) {\n      if (!w.isEditor) {\n        for (const [k, v] of Object.entries(local_cached_value[curid].value)) {\n          delete local_cached_value[curid].value[k];\n        }\n        for (const [k, v] of Object.entries(deepClone(arg.value))) {\n          local_cached_value[curid].value[k] = v;\n        }\n      }\n      local_cached_value[curid].mounted = true;\n    }\n\n    const ref = useRef<any>(local_cached_value[curid].value);\n\n    const [_, set] = useState({});\n    const local = ref.current;\n    local.render = () => {\n      const w = window as any;\n      if (!w.isEditor && w.prasiContext.render) {\n        w.prasiContext.render();\n      } else {\n        set({});\n      }\n    };\n\n    if (arg.hook) {\n      arg.hook(local);\n    }\n\n    useEffect(() => {\n      if (meta.parent?.instance_id && metas) {\n        const parent_meta = metas[meta.parent?.instance_id];\n        if (parent_meta && parent_meta.instances) {\n          for (const [k, v] of Object.entries(\n            parent_meta.instances[meta.parent.instance_id]\n          )) {\n            if (v === meta.item.id) {\n              id = k;\n              break;\n            }\n          }\n        }\n      }\n\n      let should_run = !init_local_effect[id];\n      if (should_run) {\n        if (typeof init_local_effect === \"object\") {\n          init_local_effect[id] = true;\n        }\n\n        const fn = async () => {\n          if (arg.effect) {\n            await arg.effect(local);\n          }\n        };\n\n        fn();\n      }\n\n      return () => {\n        local_cached_value[curid].mounted = false;\n      };\n    }, [...(arg.deps || []), location.pathname]);\n\n    useEffect(() => {\n      if (isEditor) {\n        if (local_cached_value[id] === null) {\n          const fn = async () => {\n            if (arg.effect) {\n              await arg.effect(local);\n              if (isEditor) {\n                local_cached_value[id] = local;\n              }\n            }\n          };\n          fn();\n        }\n      }\n    }, [local_cached_value[id]]);\n\n    const result = modifyChild(children, {\n      ...meta.script?.scope,\n      [arg.name]: local,\n    });\n    return result;\n  };\n};\n","import { createId } from \"@paralleldrive/cuid2\";\nimport { IItem, MItem } from \"../../../../utils/types/item\";\nimport { FNCompDef } from \"../../../../utils/types/meta-fn\";\nimport { IMeta } from \"../../utils/types\";\nimport { codeBuild } from \"./code-build\";\n\nconst w = window as unknown as {\n  prasiEditDevItem: Record<string, Record<string, SingleChange[]>>;\n};\n\ntype SingleChange =\n  | { type: \"set\"; name: string; value: any }\n  | ({ type: \"prop\"; name: string } & PropVal)\n  | { type: \"child\"; childs: ((IItem & PrasiEdit) | SimpleItem)[] };\n\nexport type PropVal =\n  | { mode: \"string\"; value: string }\n  | { mode: \"raw\"; value: string; valueBuilt?: string }\n  | { mode: \"jsx\"; value: null | (IItem & PrasiEdit) | SimpleItem };\n\ntype ParentArg = {\n  item: IItem & PrasiEdit;\n  child_type: \"jsx\" | \"child\";\n  child_idx: number;\n};\n\ntype SimpleItem = Partial<Omit<IItem, \"component\">> & {\n  component?: { id: string; props: Record<string, PropVal> };\n};\n\nexport type PrasiEdit = {\n  edit: {\n    setValue: <T extends keyof IItem>(name: T, value: IItem[T]) => void;\n    setProp: (name: string, value: PropVal | string) => void;\n    pending: SingleChange[];\n    childs: (IItem & PrasiEdit)[];\n    setChilds: (childs: ((IItem & PrasiEdit) | SimpleItem)[]) => void;\n    readonly parent: null | ParentArg;\n    commit: () => Promise<void>;\n    readonly props?: Record<string, PropVal>;\n  };\n};\n\nexport const devItem = (\n  metas: Record<string, IMeta>,\n  mitem: MItem,\n  page_id: string,\n  _added?: Record<string, any>\n) => {\n  const added = _added || {};\n  const id = mitem.get(\"id\") || \"\";\n\n  if (!w.prasiEditDevItem) {\n    w.prasiEditDevItem = {};\n  }\n  let pedit = w.prasiEditDevItem[page_id];\n  if (!pedit) {\n    w.prasiEditDevItem[page_id] = {};\n    pedit = w.prasiEditDevItem[page_id];\n  }\n\n  const initChanges = () => {\n    const id = mitem.get(\"id\") || \"\";\n    let changes = pedit[id];\n    if (!changes) {\n      pedit[id] = [];\n      changes = pedit[id];\n    }\n    return changes;\n  };\n\n  const item = mitem.toJSON() as IItem;\n\n  const result = {\n    ...item,\n    edit: {\n      get props() {\n        if (item.component?.props) {\n          const result: Record<string, PropVal> = {};\n          for (const [k, v] of Object.entries(item.component.props)) {\n            if (v.content) {\n              const content = mitem\n                .get(\"component\")\n                ?.get(\"props\")\n                ?.get(k)\n                ?.get(\"content\");\n\n              if (content) {\n                const id = content.get(\"id\") || \"\";\n                if (added[id]) {\n                  result[k] = {\n                    mode: \"jsx\",\n                    value: added[id],\n                  };\n                } else {\n                  result[k] = {\n                    mode: \"jsx\",\n                    value: devItem(metas, content, page_id, added),\n                  };\n                }\n              } else {\n                result[k] = {\n                  mode: \"jsx\",\n                  value: null as any,\n                };\n              }\n            } else {\n              let vbuilt =\n                typeof v.valueBuilt === \"string\"\n                  ? (v.valueBuilt.trim() as string)\n                  : \"\";\n              if (vbuilt.endsWith(\";\\n\")) {\n                vbuilt = vbuilt.substring(0, vbuilt.length - \";\\n\".length);\n              }\n              if (vbuilt && vbuilt === v.value.trim()) {\n                const fn = new Function(`return ${v.value}`);\n                result[k] = { mode: \"string\", value: fn() };\n              } else {\n                result[k] = {\n                  mode: \"raw\",\n                  value: v.value,\n                  valueBuilt: v.valueBuilt,\n                };\n              }\n            }\n          }\n          return result;\n        }\n        return undefined;\n      },\n      get pending() {\n        return [];\n      },\n      async commit() {\n        const result = {} as Record<string, any>;\n        const compile = {} as Record<\n          string,\n          { value: string; valueBuilt?: string }\n        >;\n\n        if (mitem) {\n          for (const [item_id, changes] of Object.entries(pedit)) {\n            const meta = metas[item_id];\n            if (!meta) continue;\n            if (!meta.mitem) continue;\n\n            const mitem = meta.mitem;\n            const item = mitem.toJSON();\n            if (item && item.component) {\n              const props = item?.component?.props as Record<string, FNCompDef>;\n\n              if (!props) {\n                console.log(item, props);\n                return;\n              }\n              const src = {} as Record<string, string>;\n              for (const c of changes) {\n                if (c.type === \"prop\" && props) {\n                  if (props[c.name]) {\n                    if (c.mode === \"string\") {\n                      props[c.name].value = JSON.stringify(c.value);\n                      props[c.name].valueBuilt = JSON.stringify(c.value);\n                    } else if (c.mode === \"raw\") {\n                      props[c.name].value = c.value;\n                      if (c.valueBuilt) {\n                        props[c.name].valueBuilt = c.valueBuilt;\n                      } else {\n                        src[c.name] = c.value;\n                      }\n                    } else if (c.mode === \"jsx\") {\n                      if (!props[c.name]) {\n                        props[c.name] = {\n                          meta: { type: \"content-element\" },\n                        } as any;\n                      }\n                      if (c.value) {\n                        props[c.name].content = removeEditFromChilds(\n                          [c.value],\n                          compile\n                        )[0];\n                      }\n                    }\n                  }\n                } else {\n                  if (c.type === \"set\" && typeof c.value === \"object\") {\n                    for (const [k, v] of Object.entries(c.value) as any) {\n                      item[k] = v;\n                    }\n                  } else if (c.type === \"child\" && Array.isArray(c.childs)) {\n                    if (item.component?.id) {\n                      if (!item.component.props) {\n                        item.component.props = {};\n                      }\n\n                      item.component.props.child = {\n                        meta: { type: \"content-element\" },\n                        content: {\n                          type: \"item\",\n                          id: createId(),\n                          name: \"child\",\n                          childs: removeEditFromChilds(\n                            c.childs.filter((e) => e),\n                            compile\n                          ),\n                        },\n                      };\n                    } else {\n                      const childs = removeEditFromChilds(\n                        c.childs.filter((e) => e),\n                        compile\n                      );\n                      item.childs = childs;\n                    }\n                  }\n                }\n              }\n\n              for (const [k, v] of Object.entries(compile)) {\n                src[k] = v.value;\n              }\n              let code_result = await codeBuild(src);\n              await new Promise((done) => {\n                setTimeout(done);\n              });\n\n              if (props) {\n                for (const [k, v] of Object.entries(code_result) as any) {\n                  if (props[k]) {\n                    props[k].valueBuilt = v;\n                  } else if (compile[k]) {\n                    compile[k].valueBuilt = v;\n                  }\n                }\n              }\n\n              result[item_id] = item;\n            }\n          }\n\n          mitem.doc?.transact(() => {\n            for (const [k, v] of Object.entries(result)) {\n              const m = metas[k];\n\n              if (m.mitem) {\n                syncronize(m.mitem as any, v);\n              }\n            }\n          });\n        }\n      },\n      setValue(name, value) {\n        const changes = initChanges();\n\n        let _value: any = value;\n\n        if (name === \"childs\") {\n          throw new Error(\"Please modify childs via .child\");\n        }\n\n        changes.push({ type: \"set\", name, value: _value });\n      },\n      setProp(name, value) {\n        const changes = initChanges();\n        if (typeof value === \"string\") {\n          changes.push({\n            type: \"prop\",\n            mode: \"string\",\n            name,\n            value,\n          });\n        } else {\n          if (value.mode === \"string\") {\n            changes.push({\n              type: \"prop\",\n              mode: \"string\",\n              name,\n              value: value.value,\n            });\n          } else if (value.mode === \"raw\") {\n            changes.push({\n              type: \"prop\",\n              mode: \"raw\",\n              name,\n              value: value.value,\n              valueBuilt: value.valueBuilt,\n            });\n          } else if (value.mode === \"jsx\") {\n            changes.push({\n              type: \"prop\",\n              mode: \"jsx\",\n              name,\n              value: value.value,\n            });\n          }\n        }\n      },\n      setChilds(childs) {\n        const changes = initChanges();\n        changes.push({ type: \"child\", childs });\n      },\n      get childs() {\n        if (item.component?.id) {\n          const child = item.component?.props.child;\n          if (child && child.content) {\n            const m = mitem\n              .get(\"component\")\n              ?.get(\"props\")\n              ?.get(\"child\")\n              ?.get(\"content\");\n            if (m) {\n              const id = m.get(\"id\") || \"\";\n              if (added[id]) {\n                return [added[id]];\n              }\n              return [devItem(metas, m, page_id, added)];\n            }\n          }\n          return [];\n        }\n\n        if (item.childs) {\n          return item.childs\n            .map((e) => {\n              if (e) {\n                const m = metas[e.id];\n\n                if (added[e.id]) {\n                  return added[e.id];\n                }\n                if (m && m.mitem)\n                  return devItem(metas, m.mitem, page_id, added);\n              }\n            })\n            .filter((e) => e);\n        }\n\n        return [];\n      },\n      get parent() {\n        if (mitem) {\n          const parent = mitem.parent.toJSON();\n          let parent_id = null;\n          if (Array.isArray(parent)) {\n            parent_id = (mitem.parent?.parent as any).get(\"id\");\n          } else {\n            const parent = mitem.parent?.parent?.parent?.parent as any;\n            if (\n              typeof parent === \"object\" &&\n              typeof parent.get === \"function\"\n            ) {\n              parent_id = parent.get(\"id\");\n            }\n          }\n\n          const parent_meta = metas[parent_id]?.mitem;\n          if (parent_meta) {\n            const item = added[parent_id]\n              ? added[parent_id]\n              : devItem(metas, parent_meta, page_id, added);\n\n            if (Array.isArray(parent)) {\n              return {\n                item,\n                child_type: \"child\",\n                child_idx: parent.findIndex((e) => e.id === item.id),\n              };\n            } else {\n              return { item, child_type: \"prop\" };\n            }\n          }\n        }\n        return null;\n      },\n    },\n  } as IItem & PrasiEdit;\n\n  added[id] = result;\n\n  return result;\n};\n\nconst complexifyProps = (\n  props: Record<string, PropVal>,\n  compileValueBuilt: Record<string, { value: string; valueBuilt?: string }>\n) => {\n  const result: Record<string, FNCompDef> = {};\n  for (const [k, v] of Object.entries(props)) {\n    if (v.mode) {\n      if (v.mode === \"string\") {\n        result[k] = {\n          value: JSON.stringify(v.value),\n          valueBuilt: JSON.stringify(v.value),\n          meta: { type: \"text\" },\n        };\n      } else if (v.mode === \"jsx\" && v.value) {\n        result[k] = {\n          value: \"\",\n          valueBuilt: \"\",\n          content: removeEditFromChilds([v.value], compileValueBuilt)[0],\n          meta: { type: \"content-element\" },\n        };\n      } else if (v.mode === \"raw\") {\n        result[k] = {\n          value: v.value,\n          valueBuilt: v.valueBuilt,\n          meta: { type: \"text\" },\n        };\n      }\n    } else {\n      result[k] = v;\n    }\n  }\n  return result;\n};\n\nconst removeEditFromChilds = (\n  childs: (SimpleItem | (IItem & PrasiEdit))[],\n  compileValueBuilt: Record<string, { value: string; valueBuilt?: string }>\n) => {\n  let compile = compileValueBuilt || {};\n  const result = childs.map((e) => {\n    const item: any = { ...e };\n    delete item.edit;\n\n    if (!item.id) {\n      item.id = createId();\n    }\n\n    if (item.component) {\n      if (!item.component.instances) {\n        item.component.instances = {};\n      }\n      if (!item.component.ref_ids) {\n        item.component.ref_ids = {};\n      }\n\n      if (item.component?.props) {\n        item.component.props = complexifyProps(item.component.props, compile);\n\n        for (const [k, v] of Object.entries(item.component.props) as any) {\n          if (!v.valueBuilt && v.value) {\n            compile[item.id + \"|||\" + k] = v;\n          }\n\n          if (v.content) {\n            v.content = removeEditFromChilds([v.content], compile)[0];\n          }\n        }\n      }\n    }\n\n    if (item.childs) {\n      item.childs = removeEditFromChilds(item.childs, compile);\n    } else {\n      item.childs = [];\n    }\n\n    return item;\n  });\n  return result;\n};\n","import { IItem } from \"../../../../utils/types/item\";\nimport { IMeta } from \"../../utils/types\";\nimport { PrasiEdit, PropVal } from \"./item-dev\";\n\nexport const prodItem = (\n  metas: Record<string, IMeta>,\n  item: IItem,\n  page_id: string\n) => {\n  return {\n    ...item,\n    edit: {\n      setChilds(childs) {},\n      get childs() {\n        if (item.component?.id) {\n          const child = item.component?.props.child;\n          if (child.content) {\n            return [prodItem(metas, child.content, page_id)];\n          }\n          return [];\n        }\n\n        if (item.childs) {\n          return item.childs\n            .map((e) => {\n              if (e) {\n                const m = metas[e.id];\n                if (m && m.item) return prodItem(metas, m.item, page_id);\n              }\n            })\n            .filter((e) => e);\n        }\n\n        return [];\n      },\n      get props() {\n        if (item.component?.props) {\n          const result: Record<string, PropVal> = {};\n          for (const [k, v] of Object.entries(item.component.props)) {\n            if (v.content) {\n              const content = item.component?.props?.[k]?.content;\n\n              if (content) {\n                result[k] = {\n                  mode: \"jsx\",\n                  value: prodItem(metas, content, page_id),\n                };\n              } else {\n                result[k] = {\n                  mode: \"jsx\",\n                  value: null as any,\n                };\n              }\n            } else {\n              let vbuilt =\n                typeof v.valueBuilt === \"string\"\n                  ? (v.valueBuilt.trim() as string)\n                  : \"\";\n              if (vbuilt.endsWith(\";\\n\")) {\n                vbuilt = vbuilt.substring(0, vbuilt.length - \";\\n\".length);\n              }\n              if (vbuilt && vbuilt === v.value.trim()) {\n                const fn = new Function(`return ${v.value}`);\n                result[k] = { mode: \"string\", value: fn() };\n              } else {\n                result[k] = {\n                  mode: \"raw\",\n                  value: v.value,\n                  valueBuilt: v.valueBuilt,\n                };\n              }\n            }\n          }\n          return result;\n        }\n        return undefined;\n      },\n      async commit() {},\n      get parent() {\n        const meta = metas[item.id];\n        if (meta && meta.parent?.id) {\n          const parent = metas[meta.parent.id];\n          return prodItem(metas, parent.item, page_id);\n        }\n        return null as any;\n      },\n      pending: [],\n      setProp(name, value) {},\n      setValue(name, value) {},\n    } as PrasiEdit[\"edit\"],\n  };\n};\n","import {\n  FC,\n  ReactElement,\n  ReactNode,\n  Suspense,\n  isValidElement,\n  useEffect,\n} from \"react\";\nimport { w } from \"../../../../utils/types/general\";\nimport { IMeta } from \"../../../ed/logic/ed-global\";\nimport { ErrorBox } from \"../../utils/error-box\";\nimport { VG } from \"../global\";\nimport { viParts } from \"../parts\";\nimport { viScriptArg } from \"./arg\";\nimport { updatePropScope } from \"./eval-prop\";\nimport { extractNavigate } from \"./extract-nav\";\nimport { createViLocal } from \"./local\";\nimport { createViPassProp } from \"./passprop\";\nimport { devItem } from \"./item-dev\";\nimport { prodItem } from \"./item-prod\";\n\nexport const viEvalScript = (\n  vi: {\n    page: VG[\"page\"];\n    mode: VG[\"mode\"];\n    layout: VG[\"layout\"];\n    site: { db: any; api: any };\n    comp: VG[\"comp\"];\n    meta: VG[\"meta\"];\n    visit?: VG[\"visit\"];\n    script?: { init_local_effect: any };\n    on_nav_loaded?: VG[\"on_preload\"];\n  },\n  meta: IMeta,\n  is_layout: boolean,\n  passprop: any,\n  depth: number,\n  parent_key?: any\n) => {\n  const parts = viParts(vi, meta, is_layout, passprop, depth);\n\n  if (vi.visit) vi.visit(meta, parts);\n  if (!meta.script) {\n    meta.script = {\n      scope: passprop,\n      result: null,\n      Local: createViLocal(vi, is_layout, meta),\n      PassProp: createViPassProp(vi, is_layout, meta, passprop, depth),\n    };\n  } else {\n    meta.script.scope = passprop;\n  }\n\n  const script = meta.script;\n  const exports = (window as any).exports;\n\n  const arg = {\n    useEffect,\n    children: parts.props.children,\n    props: parts.props,\n    Local: script?.Local,\n    db: vi.site.db,\n    api: vi.site.api,\n    PassProp: script?.PassProp,\n    ErrorBox: ErrorBox,\n    newElement: () => {},\n    __props: passprop,\n    _item: meta.mitem\n      ? devItem(vi.meta, meta.mitem, vi.page.cur.id)\n      : prodItem(vi.meta, meta.item, vi.page.cur.id),\n    _meta: vi.meta,\n    render: (jsx: ReactNode) => {\n      let result = jsx;\n      if (isValidElement(jsx) && jsx.props.children) {\n        const override_children = (\n          el: ReactElement<{ children: any }>\n        ): {\n          should_replace: boolean;\n          el: ReactElement;\n        } => {\n          let should_replace = false;\n          let new_childs = [];\n\n          if (isValidElement(el)) {\n            if (el.type === meta.script?.PassProp) {\n              return {\n                should_replace: true,\n                el: {\n                  ...el,\n                  props: { ...el.props, internal_key: el.key },\n                },\n              };\n            }\n\n            if (el.props?.children) {\n              if (!Array.isArray(el.props.children)) {\n                el.props.children = [el.props.children];\n              }\n              if (Array.isArray(el.props.children)) {\n                for (const child of el.props.children) {\n                  if (Array.isArray(child)) {\n                    const sub_child = [];\n                    let sub_replace = false;\n                    for (const c of child) {\n                      let nc = override_children(c);\n                      if (nc.should_replace) {\n                        sub_child.push(nc.el);\n                        sub_replace = true;\n                      } else {\n                        sub_child.push(c);\n                      }\n                    }\n                    if (sub_replace) {\n                      should_replace = true;\n                      new_childs.push(sub_child);\n                    } else {\n                      new_childs.push(child);\n                    }\n                  } else if (typeof child === \"object\" && child) {\n                    if (child.type === meta.script?.PassProp) {\n                      should_replace = true;\n                      new_childs.push({\n                        ...child,\n                        props: {\n                          ...child.props,\n                          internal_key: child.props.key,\n                        },\n                      });\n                    }\n                  } else {\n                    new_childs.push(child);\n                  }\n                }\n              }\n            }\n          }\n\n          return {\n            should_replace,\n            el: { ...el, props: { ...el.props, children: new_childs } },\n          };\n        };\n        const res = override_children(jsx as any);\n\n        if (res.should_replace) {\n          result = res.el;\n        }\n      }\n\n      if (script) script.result = <Suspense>{result}</Suspense>;\n    },\n    params,\n    ...viScriptArg(vi),\n    ...exports,\n    ...passprop,\n  };\n\n  if (typeof passprop === \"object\") {\n    for (const [k, v] of Object.entries(passprop)) {\n      if (typeof v === \"object\" && v && (v as any)._jsx) {\n        const jprop = v as unknown as {\n          _jsx: true;\n          fn: (arg: { passprop: any; meta: IMeta }) => ReactNode;\n        };\n        arg[k] = (\n          <JsxProp fn={jprop.fn} passprop={{ ...passprop }} meta={meta} />\n        );\n      }\n    }\n  }\n\n  if (!w.isEditor && meta.item.adv?.js) {\n    extractNavigate(vi, meta.item.adv.js);\n  }\n\n  const js = meta.item.adv?.jsBuilt || \"\";\n  const src = replaceWithObject(js, replacement) || \"\";\n\n  if (js.includes(\"parent_props\")) {\n    console.log(meta.item.name, arg);\n  }\n\n  const final_src = `\\\n// ${meta.item.name}: ${meta.item.id} \ntry {\n  ${src}\n} catch (e) {\n  console.error(\\`\\\\\nError in item ${meta.item.name}: ${meta.item.id} \n\n$\\{__js}\n\nERROR: $\\{e.message}\n\\`)\n}\n  `;\n  try {\n    const fn = new Function(...Object.keys(arg), \"__js\", final_src);\n    fn(...Object.values(arg), meta.item.adv?.js);\n  } catch (e: any) {\n    console.error(`\\n\n// Syntax Error in ${meta.item.name}: ${meta.item.id} \n// arg: ${Object.keys(arg).join(\", \")}\n\n${final_src}\n\n${e.message}\n`);\n  }\n\n  updatePropScope(vi, meta, passprop, parent_key);\n};\n\nconst JsxProp: FC<{\n  fn: (arg: { passprop: any; meta: IMeta }) => ReactNode;\n  meta: IMeta;\n  passprop: any;\n}> = ({ fn, meta, passprop }) => {\n  return fn({ passprop, meta });\n};\n\nexport const replacement = {\n  \"stroke-width\": \"strokeWidth\",\n  \"fill-rule\": \"fillRule\",\n  \"clip-rule\": \"clipRule\",\n  \"stroke-linejoin\": \"strokeLinejoin\",\n  \"stroke-linecap\": \"strokeLinecap\",\n  \"clip-path\": \"clipPath\",\n  \"stroke-miterlimit\": \"strokeMiterlimit\",\n};\n\nexport const replaceWithObject = (tpl: string, data: any) => {\n  let res = tpl;\n  for (const [k, v] of Object.entries(data)) {\n    res = res.replaceAll(k, v as string);\n  }\n  return res;\n};\n","import { createId } from \"@paralleldrive/cuid2\";\nimport type { Doc } from \"yjs\";\nimport { FMCompDef } from \"../../../../utils/types/meta-fn\";\nimport { IMeta, active } from \"../../../ed/logic/ed-global\";\nimport { VG } from \"../global\";\nimport { ViRender } from \"../render\";\nimport { viScriptArg } from \"./arg\";\nimport { codeBuild } from \"./code-build\";\nimport { replaceWithObject, replacement } from \"./eval-script\";\nimport { extractNavigate } from \"./extract-nav\";\n\nexport const w = window as any;\n\nexport const viEvalProps = (\n  vi: {\n    layout: VG[\"layout\"];\n    mode: VG[\"mode\"];\n    meta: VG[\"meta\"];\n    site: { db: any; api: any };\n    page: VG[\"page\"];\n    on_nav_loaded?: VG[\"on_preload\"];\n  },\n  meta: IMeta,\n  is_layout: boolean,\n  passprop: any,\n  depth: number,\n  parent_key?: any\n) => {\n  if (meta.item.component?.id) {\n    let script = meta.item.script;\n\n    if (parent_key) {\n      if (!meta.item.script_keyed) meta.item.script_keyed = {};\n      if (!meta.item.script_keyed[parent_key])\n        meta.item.script_keyed[parent_key] = {};\n      script = meta.item.script_keyed[parent_key];\n    } else {\n      if (!meta.item.script) {\n        meta.item.script = {};\n      }\n      script = meta.item.script;\n    }\n\n    if (!script) return;\n\n    const exports = (window as any).exports;\n    const arg = {\n      ...exports,\n      db: vi.site.db,\n      api: vi.site.api,\n      ...viScriptArg(vi),\n      ...passprop,\n      params,\n    };\n\n    script.props = {};\n    let fails = new Set<string>();\n    if (!!meta.item.component.props) {\n      const _props: any = {};\n      for (const [name, prop] of Object.entries(meta.item.component.props)) {\n        try {\n          if (prop.meta?.type === \"content-element\") {\n            let val = {\n              _jsx: true,\n              fn: (arg: { passprop: any; meta: IMeta; prop_name: string }) => {\n                const id = prop.content?.id;\n                if (id) {\n                  const m = is_layout ? vi.layout?.meta[id] : vi.meta[id];\n\n                  if (!m) return null;\n\n                  const instances = meta.instances;\n                  if (!arg.meta.item.originalId || !instances) {\n                    return null;\n                  }\n\n                  const instance = instances[meta.item.id];\n                  if (!instance) return null;\n                  const original_id = arg.meta.item.originalId;\n                  if (\n                    m.mitem &&\n                    ((prop.jsxCalledBy &&\n                      (!prop.jsxCalledBy.includes(original_id) ||\n                        prop.jsxCalledBy.length !== 2)) ||\n                      !prop.jsxCalledBy)\n                  ) {\n                    const mprop = meta.mitem\n                      ?.get(\"component\")\n                      ?.get(\"props\")\n                      ?.get(name);\n                    if (mprop) {\n                      let mjby = mprop.get(\"jsxCalledBy\");\n                      if (!mjby || typeof mjby !== \"object\") {\n                        mprop.set(\"jsxCalledBy\", [meta.item.id, original_id]);\n                      } else {\n                        if (\n                          Array.isArray(mjby) &&\n                          (!mjby.includes(original_id) ||\n                            mjby.length !== 2 ||\n                            mjby[0] !== meta.item.id ||\n                            mjby[1] !== original_id)\n                        ) {\n                          mprop.set(\"jsxCalledBy\", [meta.item.id, original_id]);\n                        }\n                      }\n                    }\n                  }\n\n                  return (\n                    <ViRender\n                      meta={m}\n                      passprop={arg.passprop}\n                      is_layout={is_layout}\n                      depth={depth + 1}\n                    />\n                  );\n                }\n                return null;\n              },\n            };\n\n            arg[name] = val;\n\n            if (passprop) {\n              passprop[name] = val;\n            }\n            continue;\n          }\n\n          if (prop.value) {\n            extractNavigate(vi, prop.value);\n          }\n\n          if (!prop.valueBuilt && prop.value && meta.mitem) {\n            const mprop = meta.mitem?.get(\"component\")?.get(\"props\")?.get(name);\n            if (mprop) {\n              updatePropValueBuilt(mprop, prop.value);\n              return;\n            }\n          }\n\n          let js = prop.valueBuilt || \"\";\n\n          if (js.startsWith(`const _jsxFileName = \"\";`)) {\n            js = `(() => { ${js.replace(\n              `const _jsxFileName = \"\";`,\n              `const _jsxFileName = \"\"; return `\n            )} })()`;\n          }\n\n          const src = replaceWithObject(js, replacement) || \"\";\n\n          const fn = new Function(\n            ...Object.keys(arg),\n            `// [${meta.item.name}] ${name}: ${meta.item.id} \n  return ${src}\n    `\n          );\n\n          script.props[name] = { value: src, valueBuilt: src };\n          let val = fn(...Object.values(arg));\n\n          if (typeof val === \"function\") {\n            val = (...args: any[]) => {\n              const definer = new Function(\n                ...Object.keys(arg),\n                `// [${meta.item.name}] ${name}: ${meta.item.id} \nreturn ${src.trim()}\n`\n              );\n\n              const fn = definer(...Object.values(arg));\n              return fn(...args);\n            };\n          }\n\n          arg[name] = val;\n          _props[name] = val;\n\n          if (passprop) {\n            passprop[name] = val;\n          }\n        } catch (e) {\n          fails.add(name);\n        }\n      }\n\n      if (location.pathname.startsWith(\"/ed/\") && active.item_id) {\n        if (meta.item.id === active.item_id) {\n          active.scope = {};\n          for (const [k, v] of Object.entries(passprop)) {\n            active.scope[k] = v;\n          }\n\n          active.scope.self_props = _props;\n        }\n      }\n    }\n  }\n};\n\nconst conf = {\n  timeout: null as any,\n  set: new WeakSet<FMCompDef>(),\n  map: {} as Record<string, { mprop: FMCompDef }>,\n  src: {} as Record<string, string>,\n};\nconst updatePropValueBuilt = (mprop: FMCompDef, src: string) => {\n  if (!conf.set.has(mprop)) {\n    conf.set.add(mprop);\n    const id = createId();\n    conf.map[id] = { mprop };\n    conf.src[id] = src;\n  }\n  clearTimeout(conf.timeout);\n  conf.timeout = setTimeout(async () => {\n    const result = await codeBuild(conf.src);\n\n    let doc = null as unknown as Doc;\n    for (const [k, v] of Object.entries(result)) {\n      const mprop = conf.map[k].mprop;\n      if (!doc && mprop.doc) {\n        doc = mprop.doc;\n        break;\n      }\n    }\n    if (doc) {\n      doc.transact(() => {\n        for (const [k, v] of Object.entries(result)) {\n          const mprop = conf.map[k].mprop;\n          mprop.set(\"valueBuilt\", v);\n        }\n      });\n\n      conf.set = new WeakSet();\n      conf.map = {};\n      conf.src = {};\n    }\n  }, 300);\n};\n\nexport const updatePropScope = (\n  vi: { site: { db: any; api: any } },\n  meta: IMeta,\n  scope: any,\n  parent_key?: any\n) => {\n  const script = parent_key\n    ? meta.item.script_keyed?.[parent_key]\n    : meta.item.script;\n\n  if (!script) return;\n\n  if (script.props) {\n    const scopes = { ...scope, api: vi.site.api, db: vi.site.db };\n    for (const [name, prop] of Object.entries(script.props)) {\n      if (prop.fn) {\n        const fn = new Function(\n          ...Object.keys(scopes),\n          `// [${meta.item.name}] ${name}: ${meta.item.id} \n  return ${prop.value || \"\"}\n    `\n        );\n        prop.fn = fn(...Object.values(scopes));\n      }\n    }\n  }\n};\n","import { FC, ReactNode, useState } from \"react\";\nimport { useGlobal } from \"prasi-utils\";\nimport { IMeta } from \"../../ed/logic/ed-global\";\nimport { ViGlobal } from \"./global\";\nimport { ViChild } from \"./render\";\nimport { viEvalProps } from \"./script/eval-prop\";\nimport { viEvalScript } from \"./script/eval-script\";\n\nexport const ViScript: FC<{\n  meta: IMeta;\n  is_layout: boolean;\n  depth: number;\n  passprop?: any;\n  parent_key?: any;\n}> = ({ meta, passprop, is_layout, parent_key, depth }) => {\n  const vi = useGlobal(ViGlobal, \"VI\");\n  const [_, _set] = useState({});\n  meta.render = () => {\n    _set({});\n  };\n\n  let _pass = passprop;\n  if (meta.item.component?.id) {\n    if (!_pass) _pass = {};\n    viEvalProps(vi, meta, is_layout, _pass, depth, parent_key);\n  }\n\n  if (meta.item.adv?.html) {\n    return (\n      <ViChild\n        meta={meta}\n        passprop={_pass}\n        is_layout={is_layout}\n        depth={depth}\n      />\n    );\n  }\n\n  if (meta.item.adv?.js) {\n    viEvalScript(vi, meta, is_layout, _pass, depth, parent_key);\n\n    if (meta.script) return meta.script.result;\n  }\n\n  return (\n    <ViChild meta={meta} passprop={_pass} is_layout={is_layout} depth={depth} />\n  );\n};\n","import { FC, Fragment, ReactNode } from \"react\";\nimport { useGlobal } from \"prasi-utils\";\nimport { IMeta } from \"../../ed/logic/ed-global\";\nimport { ErrorBox } from \"../utils/error-box\";\nimport { ViGlobal } from \"./global\";\nimport { viParts } from \"./parts\";\nimport { ViScript } from \"./script\";\n\nconst MAX_RENDER_IN_SECOND = 70;\n\nconst JS_CONFIG = {\n  debug: !!localStorage.getItem(\"prasi-js-debug\"),\n};\n\nexport const render_stat = {\n  enabled: false,\n  meta: {} as Record<string, { last_render: number; count: number }>,\n};\nexport const ViRender: FC<{\n  meta: IMeta;\n  children?: ReactNode;\n  passprop?: any;\n  is_layout: boolean;\n  parent_key?: any;\n  depth: number;\n}> = ({ meta, passprop, is_layout, parent_key, depth }) => {\n  if (render_stat.enabled) {\n    const rstat_meta = render_stat.meta;\n\n    if (!rstat_meta[meta.item.id]) {\n      rstat_meta[meta.item.id] = {\n        last_render: Math.floor(Date.now() / 1000),\n        count: 1,\n      };\n    } else {\n      if (\n        rstat_meta[meta.item.id].last_render === Math.floor(Date.now() / 1000)\n      ) {\n        rstat_meta[meta.item.id].count++;\n      } else {\n        rstat_meta[meta.item.id] = {\n          last_render: Math.floor(Date.now() / 1000),\n          count: 1,\n        };\n      }\n    }\n\n    if (rstat_meta[meta.item.id]?.count > MAX_RENDER_IN_SECOND) {\n      return (\n        <div className=\"bg-orange-100 border border-orange-300 rounded-sm text-xs flex flex-col items-center\">\n          <div className=\"text-[10px] font-bold text-red-900 self-stretch px-1\">\n            WARNING: Render loop detected in [{meta.item.name}]\n          </div>\n          <p className=\"border-b border-orange-300 px-1 pb-1 min-w-[100px]\">\n            Rendered {rstat_meta[meta.item.id]?.count} times in less than 1\n            second.\n          </p>\n        </div>\n      );\n    }\n  }\n\n  if (!meta) return null;\n  if (meta.item.hidden) return null;\n\n  if (JS_CONFIG.debug) {\n    let spaces = \"\";\n    for (let i = 0; i < depth; i++) spaces += \".\";\n    console.log(spaces + meta.item.id, meta.item.name);\n  }\n\n  if (\n    !(is_layout && meta.item.name === \"children\") &&\n    (meta.item.adv?.js || meta.item.component?.id)\n  ) {\n    return (\n      <ErrorBox meta={meta}>\n        <ViScript\n          meta={meta}\n          depth={depth}\n          is_layout={is_layout}\n          passprop={{ ...passprop }}\n          parent_key={parent_key}\n        ></ViScript>\n      </ErrorBox>\n    );\n  }\n  return (\n    <ErrorBox meta={meta}>\n      <ViChild\n        meta={meta}\n        passprop={{ ...passprop }}\n        depth={depth}\n        is_layout={is_layout}\n        parent_key={parent_key}\n      ></ViChild>\n    </ErrorBox>\n  );\n};\n\nexport const ViChild: FC<{\n  meta: IMeta;\n  is_layout: boolean;\n  passprop?: any;\n  parent_key?: any;\n  depth: number;\n}> = ({ meta, passprop, is_layout, parent_key, depth }) => {\n  const vi = useGlobal(ViGlobal, \"VI\");\n\n  if (is_layout && meta.item.name === \"children\") {\n    const childs: ReactNode[] = [];\n\n    for (const item_id of vi.entry) {\n      const meta = vi.meta[item_id];\n\n      if (meta.item.adv?.js || meta.item.component?.id) {\n        childs.push(\n          <ErrorBox meta={meta}>\n            <ViScript\n              meta={meta}\n              is_layout={false}\n              passprop={{ ...passprop }}\n              parent_key={parent_key}\n              depth={depth + 1}\n            ></ViScript>\n          </ErrorBox>\n        );\n      } else {\n        const parts = viParts(vi, meta, false, passprop, depth);\n        if (vi.visit) vi.visit(meta, parts);\n        childs.push(<div {...parts.props} />);\n      }\n    }\n\n    return (\n      <>\n        {childs.map((e, idx) => (\n          <Fragment key={idx}>{e}</Fragment>\n        ))}\n      </>\n    );\n  }\n\n  const parts = viParts(vi, meta, is_layout, passprop, depth);\n  if (vi.visit) vi.visit(meta, parts);\n\n  return <div {...parts.props} />;\n};\n","import { waitUntil } from \"prasi-utils\";\nimport { PG } from \"../../ed/logic/ed-global\";\nimport { VG } from \"../render/global\";\nimport { PrasiExt, prasi_ext } from \"./types\";\n\ntype NOTIF_ARG = {\n  user_id: any;\n  body: string;\n  title: string;\n  data?: any;\n};\n\ninterface PushNotificationSchema {\n  title?: string;\n  subtitle?: string;\n  body?: string;\n  id: string;\n  tag?: string;\n  badge?: number;\n  notification?: any;\n  data: any;\n  click_action?: string;\n  link?: string;\n  group?: string;\n  groupSummary?: boolean;\n}\ninterface ActionPerformed {\n  actionId: string;\n  inputValue?: string;\n  notification: PushNotificationSchema;\n}\n\nconst w = window as unknown as {\n  notif:\n    | {\n        send: (data: NOTIF_ARG) => Promise<void>;\n        register: (user_id: string) => void;\n        onReceive: (notif: PushNotificationSchema) => void | Promise<void>;\n        onTap: (notif: null | ActionPerformed) => void | Promise<void>;\n      }\n    | undefined;\n};\n\nexport const initExtNotif = async (vi: VG, prasi_ext: PrasiExt) => {\n  if (window.parent) {\n    window.addEventListener(\"message\", async ({ data: raw }) => {\n      if (typeof raw === \"object\" && raw.mobile) {\n        const data = raw as unknown as\n          | {\n              type: \"notification-token\";\n              token: string;\n            }\n          | { type: \"notification-tap\"; notif: ActionPerformed }\n          | { type: \"notification-receive\"; notif: PushNotificationSchema };\n\n        const waitUntil = async (fn: () => boolean) => {\n          if (!w.notif?.onTap) {\n            let ival = null as any;\n            let i = 0;\n            await new Promise(() => {\n              ival = setInterval(() => {\n                i++;\n                if (i > 20) {\n                  clearInterval(ival);\n                }\n                if (fn()) {\n                  clearInterval(ival);\n                }\n              }, 500);\n            });\n            return;\n          }\n        };\n\n        switch (data.type) {\n          case \"notification-token\":\n            prasi_ext.notif = { token: data.token };\n            w.notif = {\n              async send(data: NOTIF_ARG) {\n                if (vi && vi.site.api) {\n                  return await vi.site.api._notif(\"send\", {\n                    type: \"send\",\n                    id:\n                      typeof data.user_id === \"string\"\n                        ? data.user_id\n                        : data.user_id.toString(),\n                    body: data.body,\n                    title: data.title,\n                    data: data.data,\n                  });\n                }\n              },\n              async register(user_id: any) {\n                if (vi && vi.site.api && prasi_ext.notif?.token) {\n                  return await vi.site.api._notif(\"register\", {\n                    type: \"register\",\n                    id:\n                      typeof user_id === \"string\"\n                        ? user_id\n                        : user_id.toString(),\n                    token: prasi_ext.notif.token,\n                  });\n                }\n              },\n              onReceive(notif) {},\n              onTap(notif) {},\n            };\n\n            break;\n          case \"notification-tap\":\n            if (!w.notif?.onTap) {\n              waitUntil(() => {\n                if (w.notif?.onTap) {\n                  w.notif?.onTap(data.notif);\n                  return true;\n                }\n                return false;\n              });\n              return;\n            }\n\n            if (w.notif?.onTap) {\n              w.notif?.onTap(data.notif);\n            }\n            break;\n          case \"notification-receive\":\n            if (!w.notif?.onReceive) {\n              waitUntil(() => {\n                if (w.notif?.onReceive) {\n                  w.notif?.onReceive(data.notif);\n                  return true;\n                }\n                return false;\n              });\n            }\n            if (w.notif?.onReceive) {\n              w.notif?.onReceive(data.notif);\n            }\n            break;\n        }\n      }\n    });\n\n    window.parent.postMessage({ mobile: true, type: \"ready\" }, \"*\");\n  }\n\n  w.notif = {\n    async send(data: NOTIF_ARG) {\n      if (vi && vi.site.api) {\n        return await vi.site.api._notif(\"send\", {\n          type: \"send\",\n          id:\n            typeof data.user_id === \"string\"\n              ? data.user_id\n              : data.user_id.toString(),\n          body: data.body,\n          title: data.title,\n          data: data.data,\n        });\n      }\n    },\n  } as any;\n};\n","const w = window as unknown as {\n  prasi_ext: Record<string, PrasiExt>;\n};\nif (!w.prasi_ext) {\n  w.prasi_ext = {};\n}\n\nexport type PrasiExt = {\n  status: \"init\" | \"loading\" | \"ready\";\n  notif?: {\n    token: string;\n  };\n};\nexport const prasi_ext = w.prasi_ext;\n","import { VG } from \"../render/global\";\nimport { initExtNotif } from \"./notif\";\nimport { prasi_ext } from \"./types\";\n\nexport const initExts = async (vi: VG) => {\n  let pe = prasi_ext[vi.site.id];\n\n  if (!pe) {\n    prasi_ext[vi.site.id] = {\n      status: \"init\",\n    };\n    pe = prasi_ext[vi.site.id];\n  }\n\n  if (pe.status === \"init\") {\n    pe.status = \"loading\";\n\n    if (window.parent !== window) {\n      const send = (msg: { type: \"ready\" }) => {\n        window.parent.postMessage({ mobile: true, ...msg }, \"*\");\n      };\n      window.addEventListener(\"message\", async ({ data: raw }) => {\n        console.log(raw);\n        if (typeof raw === \"object\" && raw.mobile) {\n        }\n      });\n      send({ type: \"ready\" });\n    }\n    await initExtNotif(vi, pe);\n    pe.status = \"ready\";\n  }\n};\n","import { FC } from \"react\";\nimport { useGlobal, useLocal } from \"prasi-utils\";\nimport { Loading } from \"../../utils/ui/loading\";\nimport { ViGlobal } from \"./render/global\";\nimport { ViRender } from \"./render/render\";\nimport { ErrorBox } from \"./utils/error-box\";\nimport { initExts } from \"./exts/init\";\n\nexport const ViRoot: FC<{}> = ({}) => {\n  const vi = useGlobal(ViGlobal, \"VI\");\n  const local = useLocal({ tick: Date.now() });\n\n  vi.tick = local.tick;\n  initExts(vi);\n\n  if (vi.status !== \"ready\") {\n    return (\n      <div className=\"flex flex-1 flex-col relative\">\n        <Loading backdrop={false} />\n      </div>\n    );\n  }\n\n  const is_layout = !!vi.layout?.entry && vi.layout.entry.length > 0;\n  let entry = vi.entry;\n  if (is_layout && vi.layout?.entry) {\n    entry = vi.layout?.entry;\n  }\n\n  return (\n    <div className=\"flex flex-1 flex-col relative\">\n      {Array.isArray(entry) &&\n        entry.map((id) => {\n          const meta = is_layout ? vi.layout?.meta[id] : vi.meta[id];\n          if (meta) {\n            return (\n              <ErrorBox key={meta.item.id}>\n                <ViRender meta={meta} is_layout={is_layout} depth={0} />\n              </ErrorBox>\n            );\n          }\n          return null;\n        })}\n    </div>\n  );\n};\n","import { FC, Suspense, useEffect } from \"react\";\nimport { useGlobal } from \"prasi-utils\";\nimport { IMeta } from \"../ed/logic/ed-global\";\nimport { viLoad } from \"./load/load\";\nimport { VG, ViGlobal } from \"./render/global\";\nimport { render_stat } from \"./render/render\";\nimport { nav } from \"./render/script/extract-nav\";\nimport { ViRoot } from \"./root\";\nimport { ErrorBox } from \"./utils/error-box\";\nimport { IItem } from \"../../utils/types/item\";\n\ntype PRELOAD = Exclude<VG[\"on_preload\"], undefined>;\ntype PRELOAD_ARGS = Parameters<PRELOAD>[0];\n\nconst w = window as any;\n\nif (!w.prasi_internal) {\n  w.prasi_internal = { page: { id: \"\" } };\n}\n\nexport const Vi: FC<{\n  meta: Record<string, IMeta>;\n  mode: \"mobile\" | \"desktop\";\n  comp_load: (comp_id: string) => Promise<IItem>;\n  entry: string[];\n  preloaded?: (url: string) => boolean;\n  api_url: string;\n  site_id: string;\n  page_id: string;\n  api?: any;\n  db?: any;\n  layout?: VG[\"layout\"];\n  script: { init_local_effect: Record<string, boolean> };\n  visit?: VG[\"visit\"];\n  render_stat?: \"enabled\" | \"disabled\";\n  on_status_changed?: (status: VG[\"status\"]) => void;\n  on_preload?: VG[\"on_preload\"];\n}> = ({\n  meta,\n  entry,\n  api_url,\n  site_id,\n  api,\n  mode,\n  db,\n  visit,\n  script,\n  preloaded,\n  page_id,\n  render_stat: rs,\n  on_status_changed,\n  on_preload,\n  layout,\n  comp_load,\n}) => {\n  const vi = useGlobal(ViGlobal, \"VI\");\n  vi.mode = mode;\n  vi.entry = entry;\n  vi.on_preload = on_preload;\n  vi.comp.load = comp_load;\n\n  if (page_id) w.prasi_internal.page.id = page_id;\n\n  w.siteurl = (pathname: string, forceOriginal?: boolean) => {\n    if (pathname.startsWith(\"http://\") || pathname.startsWith(\"https://\"))\n      return pathname;\n\n    try {\n      if (\n        [\"prasi.avolut.com\"].includes(location.hostname) ||\n        location.port === \"4550\"\n      ) {\n        if (vi.site.api_url) {\n          if (!vi.site_url) {\n            vi.site_url = new URL(vi.site.api_url);\n          }\n        }\n      } else {\n        if (!vi.site_url) {\n          if (forceOriginal && vi.site.api_url) {\n            vi.site_url = new URL(vi.site.api_url);\n          } else {\n            vi.site_url = new URL(location.href);\n          }\n          vi.site_url.pathname = \"\";\n        }\n      }\n    } catch (e) {}\n\n    if (vi.site_url) {\n      const u = vi.site_url;\n      let path = pathname;\n      if (!path.startsWith(\"/\")) {\n        path = \"/\" + path;\n      }\n      if (w.prasiContext.siteUrl) {\n        path = w.prasiContext.siteUrl(path);\n      }\n\n      return `${u.protocol}//${u.host}${path}`;\n    }\n\n    return pathname;\n  };\n  w.isMobile = mode === \"mobile\";\n  w.isDesktop = mode === \"desktop\";\n  w.preloaded =\n    preloaded ||\n    ((url: string) => {\n      false;\n    });\n\n  w.preload = (_urls: PRELOAD_ARGS[\"urls\"], opt: PRELOAD_ARGS[\"opt\"]) => {\n    if (vi.on_preload) {\n      return new Promise<void>((done) => {\n        if (!vi.page.navs[page_id]) vi.page.navs[page_id] = new Set();\n        const navs = vi.page.navs[page_id];\n        const urls = typeof _urls === \"string\" ? [_urls] : _urls;\n        let all_done = true;\n        for (const url of urls) {\n          if (!navs.has(url)) {\n            navs.add(url);\n            all_done = false;\n          }\n        }\n        if (!all_done) {\n          vi.page.preload.push(done);\n          vi.on_preload?.({\n            urls: Array.from(vi.page.navs[page_id]),\n            opt: {\n              on_load: (...arg) => {\n                opt?.on_load?.(...arg);\n                for (const done of vi.page.preload) {\n                  done();\n                }\n                vi.page.preload = [];\n                vi.render();\n              },\n            },\n          });\n        } else {\n          done();\n        }\n      });\n    }\n  };\n\n  vi.layout = layout;\n  vi.page.cur.id = page_id;\n  vi.on_status_changes = on_status_changed;\n\n  if (rs === \"disabled\") {\n    render_stat.enabled = false;\n  }\n\n  if (vi.meta !== meta) {\n    vi.meta = meta;\n  }\n  if (script) {\n    vi.script.init_local_effect = script.init_local_effect;\n  }\n  vi.visit = visit;\n\n  if (vi.status === \"init\") {\n    vi.site.db = db;\n    vi.site.api = api;\n    viLoad(vi, { api_url, site_id });\n  }\n\n  if (on_preload) {\n    useEffect(() => {\n      setTimeout(() => {\n        const nav = vi.page.navs[vi.page.cur.id];\n        if (nav) {\n          on_preload({\n            urls: Array.from(nav),\n            opt: {\n              on_load(pages) {},\n            },\n          });\n        }\n      }, 500);\n    }, [vi.page.cur.id]);\n  }\n\n  return (\n    <ErrorBox>\n      <Suspense>\n        <ViRoot />\n      </Suspense>\n    </ErrorBox>\n  );\n};\n","import { set } from \"idb-keyval\";\nimport { IContent } from \"../../../utils/types/general\";\nimport { IItem } from \"../../../utils/types/item\";\nimport { ISection } from \"../../../utils/types/section\";\nimport { base } from \"./base\";\n\nexport const scanComponent = async (items: IContent[], from_root?: boolean) => {\n  const comp = base.comp;\n\n  for (const item of items) {\n    if (item && item.type !== \"text\") {\n      scanSingle(item, from_root);\n    }\n  }\n\n  const pending = Object.keys(comp.pending);\n  if (pending.length > 0) {\n    try {\n      const res = (await (\n        await fetch(base.url`_prasi/comp`, {\n          method: \"POST\",\n          body: JSON.stringify({ ids: [...pending] }),\n        })\n      ).json()) as Record<string, IItem>;\n      for (const [id, item] of Object.entries(res)) {\n        delete comp.pending[id];\n        comp.list[id] = item;\n        await set(`comp-${id}`, item);\n      }\n      if (Object.keys(comp.pending).length > 0) {\n        console.error(\n          `Warning: component not found: ${Object.keys(comp.pending)}`\n        );\n        return;\n      }\n\n      await scanComponent(Object.values(res));\n    } catch (e) {\n      console.error(e);\n    }\n  }\n};\n\nconst scanSingle = (item: IItem | ISection, from_root?: boolean) => {\n  const comp = base.comp;\n  if (item.type === \"item\") {\n    const comp_id = item.component?.id;\n\n    if (comp_id) {\n      if (!comp.list[comp_id] && !comp.pending[comp_id]) {\n        comp.pending[comp_id] = [];\n      }\n\n      if (comp.pending[comp_id]) {\n        if (!comp.pending[comp_id].find((e) => e.id === item.id)) {\n          comp.pending[comp_id].push(item);\n        }\n      }\n\n      if (comp.pending[comp_id]) {\n        if (comp.list[comp_id]) {\n          for (const item of comp.pending[comp_id]) {\n            for (const prop of Object.values(item.component?.props || {})) {\n              if (prop.content) {\n                scanSingle(prop.content, from_root);\n              }\n            }\n          }\n          delete comp.pending[comp_id];\n        }\n      }\n      if (item.component?.props) {\n        for (const prop of Object.values(item.component?.props || {})) {\n          if (prop.content) {\n            scanSingle(prop.content, from_root);\n          }\n        }\n      }\n    }\n  }\n\n  if (item.childs) {\n    for (const child of item.childs) {\n      let c = child;\n      if (c && c.type !== \"text\") {\n        scanSingle(c, from_root);\n      }\n    }\n  }\n};\n","import { get } from \"idb-keyval\";\nimport { IRoot } from \"../../../utils/types/root\";\nimport { base } from \"./base\";\n\nconst pendingPage = {} as Record<\n  string,\n  Promise<{\n    id: string;\n    url: string;\n    root: IRoot;\n  }>\n>;\n\nexport const loadPage = (page_id: string) => {\n  if (typeof pendingPage[page_id] === \"object\") return pendingPage[page_id];\n\n  pendingPage[page_id] = new Promise<{\n    id: string;\n    url: string;\n    root: IRoot;\n  }>(async (done) => {\n    let returned = false;\n\n    const cached = await get(`page-${page_id}`);\n    if (cached) {\n      done(cached);\n      returned = true;\n    }\n\n    const res = (await (\n      await fetch(base.url`_prasi/page/${page_id}`)\n    ).json()) as {\n      id: string;\n      url: string;\n      root: IRoot;\n      content_tree?: IRoot;\n    };\n\n    if (!res.root && res.content_tree) {\n      res.root = res.content_tree;\n      delete res.content_tree;\n    }\n\n    if (!returned) done(res);\n  });\n\n  return pendingPage[page_id];\n};\n\nexport const loadPages = (page_ids: string[]) => {\n  return new Promise<\n    {\n      id: string;\n      url: string;\n      root: IRoot;\n    }[]\n  >(async (done) => {\n    const result: any = {};\n    const ids = [...new Set(page_ids)];\n    let is_done = true;\n    for (const id of ids) {\n      const page = await get(`page-${id}`);\n      if (page) {\n        result[id] = page;\n      } else {\n        is_done = false;\n        break;\n      }\n    }\n\n    if (is_done) {\n      done(result);\n    }\n\n    const res = (await (\n      await fetch(base.url`_prasi/pages`, {\n        method: \"POST\",\n        body: JSON.stringify({ ids }),\n      })\n    ).json()) as {\n      id: string;\n      url: string;\n      root: IRoot;\n    }[];\n\n    if (!is_done) {\n      done(res);\n    }\n  });\n};\n\nexport const loadUrls = async (urls: string[]) => {\n  const founds = urls\n    .map((url) => {\n      return base.route.router?.lookup(url);\n    })\n    .filter((e) => e && e.id);\n\n  const result = await loadPages(founds.map((e) => e?.id) as string[]);\n  return result;\n};\n","import { base } from \"./base\";\nimport parseUA from \"ua-parser-js\";\n\nexport const detectResponsiveMode = () => {\n  const p = base;\n  if (p.site.id) {\n    if (!p.mode && !!p.site.responsive) {\n      if (\n        p.site.responsive !== \"mobile-only\" &&\n        p.site.responsive !== \"desktop-only\"\n      ) {\n        const parsed = parseUA();\n        p.mode = parsed.device.type === \"mobile\" ? \"mobile\" : \"desktop\";\n      } else if (p.site.responsive === \"mobile-only\") {\n        p.mode = \"mobile\";\n      } else if (p.site.responsive === \"desktop-only\") {\n        p.mode = \"desktop\";\n      }\n    }\n    if (localStorage.getItem(\"prasi-editor-mode\")) {\n      p.mode = localStorage.getItem(\"prasi-editor-mode\") as any;\n    }\n  }\n};\n","import axios from \"axios\";\n\n(BigInt.prototype as any).toJSON = function (): string {\n  return `BigInt::` + this.toString();\n};\nlet w = (typeof window !== \"undefined\" ? window : null) as any;\nlet g = (typeof global !== \"undefined\" ? global : undefined) as any;\n\nexport const fetchViaProxy = async (\n  target_url: string,\n  data?: any,\n  _headers?: any,\n  parse_json?: boolean\n) => {\n  const headers = { ..._headers };\n\n  let body = null as any;\n  let isFile = false;\n  let uploadProgress = null as any;\n\n  const files: File[] = [];\n  if (Array.isArray(data)) {\n    for (const item of data) {\n      if (item instanceof File) {\n        files.push(item);\n        isFile = true;\n      }\n      if (typeof item === \"function\") {\n        uploadProgress = item;\n      }\n    }\n  } else if (data instanceof File) {\n    isFile = true;\n    files.push(data);\n  }\n\n  if (!isFile) {\n    body = JSON.stringify(data);\n    headers[\"content-type\"] = \"aplication/json\";\n  } else {\n    const fd = new FormData();\n    for (const file of files) {\n      fd.append(file.name, file);\n    }\n    body = fd;\n    delete headers[\"content-type\"];\n    headers[\"enctype\"] = `multipart/form-data;`;\n  }\n\n  const to_url = new URL(target_url);\n\n  if (w !== null) {\n    const cur_url = new URL(location.href);\n    let final_url = \"\";\n\n    if (\n      // to_url.hostname === 'localhost' ||\n      to_url.host === cur_url.host ||\n      (!!g && typeof g.server_hook === \"function\")\n    ) {\n      final_url = to_url.toString();\n    } else {\n      final_url = `${cur_url.protocol}//${\n        cur_url.host\n      }/_proxy/${encodeURIComponent(to_url.toString())}`;\n    }\n\n    if (final_url) {\n      if (uploadProgress) {\n        const res = await axios({\n          method: data ? \"post\" : undefined,\n          url: final_url,\n          data: body,\n          onUploadProgress: uploadProgress,\n        });\n\n        return res.data;\n      } else {\n        const res = await fetch(\n          final_url,\n          data\n            ? {\n                method: \"POST\",\n                body,\n                headers,\n              }\n            : undefined\n        );\n        const raw = await res.text();\n        if (parse_json === false) return raw;\n\n        try {\n          return JSON.parse(raw, replacer);\n        } catch (e) {\n          return raw;\n        }\n      }\n    }\n  }\n\n  const res = await fetch(\n    to_url,\n    data\n      ? {\n          method: \"POST\",\n          body,\n          headers,\n        }\n      : undefined\n  );\n  const raw = await res.text();\n  try {\n    return JSON.parse(raw, replacer);\n  } catch (e) {\n    return raw;\n  }\n};\n\nconst replacer = (key: string, value: string) => {\n  if (typeof value === \"string\" && value.startsWith(\"BigInt::\")) {\n    return BigInt(value.substring(8));\n  }\n  return value;\n};\n\nexport const getProxyUrl = (target_url: string) => {\n  const to_url = new URL(target_url);\n\n  if (w !== null) {\n    const cur_url = new URL(location.href);\n    let final_url = \"\";\n\n    if (\n      // to_url.hostname === 'localhost' ||\n      to_url.host === cur_url.host ||\n      (!!g && typeof g.server_hook === \"function\")\n    ) {\n      final_url = to_url.toString();\n    } else {\n      final_url = `${cur_url.protocol}//${\n        cur_url.host\n      }/_proxy/${encodeURIComponent(to_url.toString())}`;\n    }\n    return final_url;\n  }\n  return to_url;\n};\n","import trim from \"lodash.trim\";\n\nexport const loadApiProxyDef = async (_url: string, with_types: boolean) => {\n  const url = trim(_url, \"/\");\n\n  await new Promise<void>((done) => {\n    const d = document;\n    const script = d.createElement(\"script\");\n    script.onload = async () => {\n      done();\n    };\n\n    if (!localStorage.getItem(\"api-ts-\" + url)) {\n      localStorage.setItem(\"api-ts-\" + url, Date.now().toString());\n    }\n\n    const url_target = new URL(url);\n    const url_cur = new URL(location.href);\n\n    url_cur.hash = \"\";\n    url_target.hash = \"\";\n    let is_remote = \"\";\n    if (url_target.host !== url_cur.host) {\n      is_remote = \"&remote=1\";\n    }\n\n    url_cur.pathname = \"\";\n    let cur_url = trim(url_cur.toString(), \"/\");\n    if (with_types) {\n      script.src = `${cur_url}/_prasi/load.js?url=${url}&v3&dev=1${is_remote}`;\n    } else {\n      script.src = `${cur_url}/_prasi/load.js?url=${url}&v3${is_remote}`;\n    }\n    script.onerror = () => {\n      done();\n    };\n\n    if (!document.querySelector(`script[src=\"${script.src}\"]`)) {\n      d.body.appendChild(script);\n    } else {\n      done();\n    }\n  });\n};\n\nconst baseUrl = (url: string) => {\n  const base = new URL(url);\n\n  return `${base.protocol}//${base.host}`;\n};\n\nconst urlPath = (url: string, pathname: string) => {\n  const base = new URL(url);\n  base.pathname = pathname;\n  return base.toString();\n};\n\nconst loadText = async (url: string, v2?: boolean) => {\n  const res = await fetch(url);\n  return await res.text();\n};\n","import { w } from \"../../../utils/types/general\";\nimport { fetchViaProxy } from \"../proxy\";\nimport { loadApiProxyDef } from \"./api-proxy-def\";\n\nexport type ApiProxy<T extends Record<string, any> = {}> = any;\n\nconst apiProxyLoaded: Record<string, Promise<void>> = {};\n\nexport const apiProxy = (api_url: string) => {\n  if (!w.prasiApi) {\n    w.prasiApi = {};\n  }\n\n  try {\n    const base = new URL(api_url);\n    let base_url = `${base.protocol}//${base.host}`;\n    if (!w.prasiApi[base_url]) {\n      if (!apiProxyLoaded[base_url]) {\n        apiProxyLoaded[base_url] = loadApiProxyDef(\n          base_url,\n          location.hostname.includes(\"prasi\")\n        );\n      }\n    }\n\n    return new Proxy(\n      {},\n      {\n        get: (_, actionName: string) => {\n          if (actionName === \"_url\") {\n            return (pathname: string, proxy?: boolean) => {\n              const to_url = new URL(base_url);\n              to_url.pathname = pathname\n                .split(\"/\")\n                .filter((e) => e)\n                .join(\"/\");\n\n              const cur_url = new URL(location.href);\n              let final_url = \"\";\n\n              if (to_url.host === cur_url.host || proxy === false) {\n                final_url = to_url.toString();\n              } else {\n                final_url = `${cur_url.protocol}//${\n                  cur_url.host\n                }/_proxy/${encodeURIComponent(to_url.toString())}`;\n              }\n              return final_url;\n            };\n          }\n\n          const createFn = (actionName: string) => {\n            return function (\n              this: { api_url: string } | undefined,\n              ...rest: any\n            ) {\n              return new Promise<any>(async (resolve, reject) => {\n                try {\n                  let api_ref = w.prasiApi[base_url];\n\n                  if (\n                    !api_ref &&\n                    apiProxyLoaded &&\n                    typeof apiProxyLoaded[base_url] === \"object\"\n                  ) {\n                    await apiProxyLoaded[base_url];\n                    api_ref = w.prasiApi[base_url];\n                  }\n\n                  if (api_ref) {\n                    if (Object.keys(api_ref).length === 0) {\n                      const url = `${base_url}/${actionName}`;\n\n                      const result = await fetchSendApi(url, rest);\n                      resolve(result);\n                      return;\n                    }\n\n                    if (actionName === \"_raw\") {\n                      const pathname = rest[0];\n                      const url = `${base_url}${pathname}`;\n\n                      const result = await fetchSendApi(url, rest.slice(1));\n                      resolve(result);\n                      return;\n                    }\n\n                    if (!api_ref.apiEntry) api_ref.apiEntry = {};\n                    if (api_ref.apiEntry && !api_ref.apiEntry[actionName]) {\n                      reject(\n                        `API ${actionName.toString()} not found, existing API: \\n   - ${Object.keys(\n                          api_ref.apiEntry || {}\n                        ).join(\"\\n   - \")}`\n                      );\n                      return;\n                    }\n\n                    let actionUrl = api_ref.apiEntry[actionName].url;\n                    const actionParams = api_ref.apiEntry[actionName].args;\n                    if (actionUrl && actionParams) {\n                      if (rest.length > 0 && actionParams.length > 0) {\n                        for (const [idx, p] of Object.entries(rest)) {\n                          const paramName = actionParams[parseInt(idx)];\n                          if (\n                            actionParams &&\n                            actionParams.includes(paramName)\n                          ) {\n                            if (\n                              !!p &&\n                              typeof p !== \"string\" &&\n                              typeof p !== \"number\"\n                            ) {\n                              continue;\n                            }\n                          }\n                          actionUrl = actionUrl.replace(\n                            `:${paramName}?`,\n                            p + \"\"\n                          );\n                          actionUrl = actionUrl.replace(\n                            `:${paramName}`,\n                            p + \"\"\n                          );\n                        }\n                      }\n\n                      const url = `${base_url}${actionUrl}`;\n\n                      const result = await fetchSendApi(url, rest);\n                      resolve(result);\n                    } else {\n                      console.error(`API Not Found: ${actionName.toString()}`);\n                    }\n                  } else {\n                    reject(\"Failed to load API [Proxy]: \" + base_url);\n                  }\n                } catch (e) {\n                  reject(e);\n                }\n              });\n            };\n          };\n          if (actionName === \"then\") {\n            return new Proxy(\n              {},\n              {\n                get: (_, actionName: string) => {\n                  return createFn(actionName);\n                },\n              }\n            );\n          }\n\n          return createFn(actionName);\n        },\n      }\n    );\n  } catch (e) {\n    return null;\n  }\n};\n\nconst fetchSendApi = async (url: string, params: any) => {\n  return await fetchViaProxy(url, params, {\n    \"content-type\": \"application/json\",\n  });\n};\n","import hash_sum from \"hash-sum\";\nimport pako, { gzip } from \"pako\";\nimport { fetchViaProxy, getProxyUrl } from \"../proxy\";\nimport { del, get, set } from \"idb-keyval\";\nimport { pack } from \"msgpackr\";\n\nconst schema_promise = {\n  tables: {} as Record<string, any>,\n  columns: {} as Record<string, any>,\n  rels: {} as Record<string, any>,\n};\n\nconst db_mode = {} as Record<string, \"msgpack\" | \"json\">;\n\nexport const dbProxy = (dburl: string) => {\n  const name = \"\";\n\n  if (!db_mode[dburl]) {\n    fetchSendDb(\n      {\n        table: \"check\",\n        action: \"check\",\n      },\n      dburl\n    ).then((res) => {\n      if (res && res.mode === \"encrypted\") {\n        db_mode[dburl] = \"msgpack\";\n      } else {\n        db_mode[dburl] = \"json\";\n      }\n    });\n  }\n\n  return new Proxy(\n    {},\n    {\n      get(_, table: string) {\n        if (table === \"_batch\") {\n          return {\n            update: async (batch: any) => {\n              return fetchSendDb(\n                {\n                  name,\n                  action: \"batch_update\",\n                  table: \"\",\n                  params: { batch },\n                },\n                dburl\n              );\n            },\n            upsert: async (arg: any) => {\n              return fetchSendDb(\n                {\n                  name,\n                  action: \"batch_upsert\",\n                  table: \"\",\n                  params: { arg },\n                },\n                dburl\n              );\n            },\n          };\n        }\n        if (table === \"_schema\") {\n          return {\n            tables: async () => {\n              if (!schema_promise.tables[dburl]) {\n                schema_promise.tables[dburl] = fetchSendDb(\n                  {\n                    name,\n                    action: \"schema_tables\",\n                    table: \"\",\n                    params: [],\n                  },\n                  dburl\n                );\n              }\n\n              return await schema_promise.tables[dburl];\n            },\n            columns: async (table: string) => {\n              if (!schema_promise.columns[dburl + \"_\" + table]) {\n                schema_promise.columns[dburl + \"_\" + table] = fetchSendDb(\n                  {\n                    name,\n                    action: \"schema_columns\",\n                    table,\n                    params: [],\n                  },\n                  dburl\n                );\n              }\n\n              return await schema_promise.columns[dburl + \"_\" + table];\n            },\n            rels: async (table: string) => {\n              if (!schema_promise.rels[dburl + \"_\" + table]) {\n                schema_promise.rels[dburl + \"_\" + table] = fetchSendDb(\n                  {\n                    name,\n                    action: \"schema_rels\",\n                    table,\n                    params: [],\n                  },\n                  dburl\n                );\n              }\n\n              return await schema_promise.rels[dburl + \"_\" + table];\n            },\n          };\n        }\n\n        if (table.startsWith(\"$\")) {\n          return (...params: any[]) => {\n            const bytes = pako.gzip(JSON.stringify(params));\n\n            return fetchSendDb(\n              {\n                name,\n                action: \"query\",\n                table,\n                params: btoa(\n                  bytes.reduce(\n                    (acc, current) => acc + String.fromCharCode(current),\n                    \"\"\n                  )\n                ),\n              },\n              dburl\n            );\n          };\n        }\n\n        return new Proxy(\n          {},\n          {\n            get(_, action: string) {\n              return async (...params: any[]) => {\n                if (table === \"query\") {\n                  table = action;\n                  action = \"query\";\n                }\n                return await fetchSendDb(\n                  {\n                    name,\n                    action,\n                    table,\n                    params,\n                  },\n                  dburl\n                );\n              };\n            },\n          }\n        );\n      },\n    }\n  );\n};\n\nconst editorQueryLoaded: Record<string, true> = {};\n\nexport const fetchSendDb = async (\n  _params: Record<string, any>,\n  dburl: string\n) => {\n  const base = new URL(dburl);\n  base.pathname = `/_dbs`;\n  const params = _params || {};\n\n  if (params.table) {\n    base.pathname += `/${params.table}`;\n  }\n  const url = base.toString();\n\n  if (typeof localStorage !== \"undefined\" && localStorage.mlsid) {\n    params.mlsid = localStorage.mlsid;\n  }\n\n  const hsum = hash_sum({ ...params, dburl });\n\n  let isEditor = false;\n  if (\n    typeof location !== \"undefined\" &&\n    base.hostname !== location.hostname &&\n    (window as any).isEditor &&\n    [\"prasi.avolut.com\", \"localhost:4550\", \"127.0.0.1:4550\"].includes(\n      location.host\n    )\n  )\n    isEditor = true;\n\n  const load = async () => {\n    let body: any = params;\n    let result = null;\n    if (db_mode[dburl] === \"msgpack\") {\n      body = gzip(pack(params), {});\n      const res = await fetch(getProxyUrl(url), { method: \"POST\", body });\n      result = await res.json();\n    } else {\n      result = await fetchViaProxy(\n        url,\n        body,\n        {\n          \"content-type\": \"application/json\",\n        },\n        false\n      );\n    }\n\n    try {\n      if (typeof result === \"string\") return JSON.parse(result);\n    } catch (e) {}\n    return result;\n  };\n\n  if (isEditor) {\n    let result = await get(`editor-db-cache-${hsum}`);\n    if (!result) {\n      result = await load();\n      editorQueryLoaded[hsum] = true;\n      set(`editor-db-cache-${hsum}`, result);\n    } else {\n      if (!editorQueryLoaded[hsum]) {\n        load().then((result) => {\n          set(`editor-db-cache-${hsum}`, result);\n        });\n        editorQueryLoaded[hsum] = true;\n      }\n    }\n\n    return result;\n  }\n\n  return await load();\n};\n","import { createId } from \"@paralleldrive/cuid2\";\nimport { deepClone } from \"prasi-utils\";\nimport { IItem } from \"../../../../utils/types/item\";\n\nexport const instantiate = (arg: {\n  item: IItem;\n  item_comp: IItem;\n  ids: Record<string, string>;\n}) => {\n  const { item, item_comp, ids } = arg;\n  const newitem = deepClone(item_comp);\n\n  walkChild(newitem, ids);\n\n  if (item.id) {\n    newitem.id = item.id;\n  }\n  newitem.hidden = item.hidden;\n\n  if (newitem.component) {\n    if (newitem.component.props && item.component && item.component.props) {\n      for (const k of Object.keys(newitem.component.props)) {\n        const cprop = item.component.props[k];\n        const nprop = newitem.component.props[k];\n        if (cprop) {\n          nprop.value = cprop.value;\n          nprop.valueBuilt = cprop.valueBuilt;\n          nprop.jsxCalledBy = cprop.jsxCalledBy;\n          nprop.content = cprop.content;\n        }\n      }\n    }\n    newitem.component.instances = item.component?.instances;\n    newitem.component.style = item.component?.style;\n  }\n\n  for (const key of Object.keys(item)) {\n    delete (item as any)[key];\n  }\n\n  for (const [k, v] of Object.entries(newitem)) {\n    (item as any)[k] = v;\n  }\n};\n\nexport const walkChild = (item: IItem, ids: Record<string, string>) => {\n  item.originalId = item.id;\n\n  if (!ids[item.id]) {\n    ids[item.id] = createId();\n  }\n\n  item.id = ids[item.id];\n\n  if (item.childs) {\n    for (const child of item.childs) {\n      walkChild(child as IItem, ids);\n    }\n  }\n};\n","import { createId } from \"@paralleldrive/cuid2\";\nimport { deepClone } from \"prasi-utils\";\nimport { IItem } from \"../../../../utils/types/item\";\nimport { FNCompDef } from \"../../../../utils/types/meta-fn\";\n\nexport const walkProp = (arg: {\n  item: IItem;\n  item_comp: IItem;\n  instance: Record<string, string>;\n  each: (name: string, prop: FNCompDef) => void;\n}) => {\n  const props = Object.entries(arg.item_comp.component?.props || {}).sort(\n    (a, b) => {\n      return a[1].idx - b[1].idx;\n    }\n  );\n  for (const [k, v] of props) {\n    let prop = deepClone(v);\n    const props = arg.item.component?.props;\n    if (props && props[k]) {\n      prop.value = props[k].value;\n      prop.valueBuilt = props[k].valueBuilt;\n      if (props[k].content) {\n        prop.content = props[k].content;\n      }\n    }\n\n    if (prop) {\n      arg.each(k, prop);\n    }\n  }\n};\n","import { IItem } from \"../../../utils/types/item\";\nimport { IMeta, ISimpleMeta } from \"../utils/types\";\n\nexport const simplifyItemChild = (item: IItem) => {\n  const newitem = {} as any;\n  for (const [k, v] of Object.entries(item)) {\n    if (k === \"childs\") {\n      newitem.childs = [];\n      if (v && Array.isArray(v)) {\n        for (const child of v) {\n          if (child.type === \"item\" && child.component) {\n            newitem.childs.push(child);\n          } else {\n            newitem.childs.push({\n              name: child.name,\n              id: child.id,\n              originalId: child.originalId,\n            });\n          }\n        }\n      }\n    } else {\n      newitem[k] = v;\n    }\n  }\n\n  return newitem as IItem;\n};\n\nexport const simplifyMeta = (allmeta: Record<string, IMeta>) => {\n  const smeta = {} as Record<string, ISimpleMeta>;\n\n  for (const [k, meta] of Object.entries(allmeta)) {\n    smeta[k] = {\n      id: meta.item.id,\n      parent: meta.parent\n        ? {\n            id: meta.parent.id,\n            comp_id: meta.parent.comp_id,\n            instance_id: meta.parent.instance_id,\n          }\n        : undefined,\n      comp:\n        meta.item.component && meta.instances\n          ? {\n              id: meta.item.component.id,\n              instances: meta.instances,\n            }\n          : undefined,\n    };\n  }\n\n  return smeta;\n};\n","import { GenMetaArg, GenMetaP, IMeta } from \"../utils/types\";\nimport { instantiate } from \"./comp/instantiate\";\nimport { walkProp } from \"./comp/walk-prop\";\nimport { genMeta } from \"./meta\";\nimport { simplifyItemChild } from \"./simplify\";\n\nexport const genComp = (p: GenMetaP, arg: GenMetaArg) => {\n  const { item } = arg;\n\n  if (item.type === \"item\" && item.component?.id && arg.parent?.item.id) {\n    let item_comp = p.comps[item.component.id];\n    if (p.on?.visit_component) {\n      p.on.visit_component(item, arg.root || arg.item);\n    }\n\n    if (!item_comp) {\n      return;\n    }\n\n    if (item_comp) {\n      let instances: undefined | typeof item.component.instances = undefined;\n\n      if (p.mode === \"page\") {\n        if (!item.component.instances) {\n          item.component.instances = {};\n        }\n        instances = item.component.instances;\n      } else {\n        instances = arg.parent?.root_instances;\n      }\n\n      if (instances) {\n        let instance = instances[item.id];\n\n        if (!instances[item.id]) {\n          instances[item.id] = {};\n          instance = instances[item.id];\n        }\n\n        instantiate({\n          item,\n          item_comp: item_comp,\n          ids: instance,\n        });\n      }\n\n      const meta: IMeta = {\n        item: simplifyItemChild(item),\n        jsx_prop: arg.jsx_prop,\n        parent: {\n          id: arg.parent.item.id,\n          comp_id: arg.parent?.comp?.component?.id,\n          instance_id: arg.parent?.instance_id,\n        },\n        instances,\n      };\n\n      if (p.on?.visit) {\n        p.on.visit(meta, item, arg.root || arg.item);\n      }\n\n      if (item.id) {\n        if (p.set_meta !== false) {\n          p.meta[item.id] = meta;\n        }\n      }\n\n      walkProp({\n        item,\n        item_comp: item_comp,\n        instance: instances ? instances[item.id] : {},\n        each(name, prop) {\n          const comp_id = item.component?.id;\n\n          if (prop.meta?.type === \"content-element\" && comp_id) {\n            if (prop.content) {\n              prop.content.name = name;\n\n              genMeta(\n                { ...p },\n                {\n                  item: prop.content,\n                  root: arg.root || prop.content,\n                  is_root: false,\n                  jsx_prop: {\n                    is_root: true,\n                    comp_id,\n                    name,\n                  },\n                  parent: {\n                    item: meta.item,\n                    instance_id: item.id,\n                    comp: item_comp,\n                    root_instances: instances,\n                  },\n                }\n              );\n            }\n          }\n        },\n      });\n\n      if (item.childs) {\n        for (const child of Object.values(item.childs)) {\n          if (child?.name?.startsWith(\"jsx:\")) continue;\n\n          if (child && Object.keys(child).length > 3) {\n            genMeta(\n              { ...p, mode: \"comp\" },\n              {\n                item: child,\n                is_root: false,\n                root: arg.root || arg.item,\n                parent: {\n                  item,\n                  instance_id: item.id,\n                  root_instances: instances,\n                  comp: item_comp,\n                },\n              }\n            );\n          }\n        }\n      }\n    }\n  }\n};\n","import { IItem } from \"../../../utils/types/item\";\nimport { GenMetaArg, GenMetaP, IMeta } from \"../utils/types\";\nimport { genComp } from \"./comp\";\nimport { simplifyItemChild } from \"./simplify\";\n\nexport const genMeta = (p: GenMetaP, arg: GenMetaArg) => {\n  const item = arg.item as IItem;\n\n  if (item.type === \"item\" && item.component?.id) {\n    if (arg.ignore_first_component !== true) {\n      genComp(p, arg);\n      return;\n    }\n  }\n\n  const meta: IMeta = {\n    item: simplifyItemChild(item),\n    parent: {\n      id: arg.parent?.item.id || \"root\",\n      instance_id: arg.parent?.instance_id,\n      comp_id: arg.parent?.comp?.component?.id,\n    },\n  };\n\n  if (arg.jsx_prop) {\n    meta.jsx_prop = arg.jsx_prop;\n  }\n\n  if (p.on?.visit) {\n    p.on.visit(meta, item, arg.root || arg.item);\n  }\n\n  if (item.id) {\n    if (p.set_meta !== false) {\n      p.meta[meta.item.id] = meta;\n    }\n  }\n\n  if (item.childs) {\n    for (const [_, v] of Object.entries(item.childs)) {\n      if (v.id) {\n        const carg: GenMetaArg = {\n          item: v,\n          is_root: false,\n          root: arg.root || arg.item,\n          parent: {\n            item: meta.item,\n            instance_id: arg.parent?.instance_id,\n            comp: arg.parent?.comp,\n            root_instances: arg.parent?.root_instances,\n          },\n        };\n        if (arg.jsx_prop) {\n          carg.jsx_prop = {\n            ...arg.jsx_prop,\n            is_root: false,\n          };\n        }\n        genMeta(p, carg);\n      }\n    }\n  }\n};\n","import trim from \"lodash.trim\";\nimport { createRouter } from \"radix3\";\nimport { apiProxy } from \"../../../base/load/api/api-proxy\";\nimport { dbProxy } from \"../../../base/load/db/db-proxy\";\nimport { IRoot } from \"../../../utils/types/root\";\nimport { genMeta } from \"../../vi/meta/meta\";\nimport { IMeta } from \"../../vi/utils/types\";\nimport { base } from \"./base\";\nimport { scanComponent } from \"./component\";\n\nconst cached = { route: null as any, promise: null as any };\n\nconst getRoute = () => {\n  if (cached.promise) return cached.promise;\n  cached.promise = new Promise<{\n    site: any;\n    urls: {\n      id: string;\n      url: string;\n    }[];\n    layout: any;\n  }>(async (done) => {\n    if (cached.route) done(cached.route);\n\n    const res = await fetch(base.url`_prasi/route`);\n    if (!res.headers.get(\"content-encoding\")) {\n      fetch(base.url`_prasi/compress/only-gz`);\n    }\n    cached.route = await res.json();\n\n    done(cached.route);\n  });\n};\n\nexport const initBaseRoute = async () => {\n  const router = createRouter<{ id: string; url: string }>();\n  const pages = [] as { id: string; url: string }[];\n  try {\n    const res = await getRoute();\n\n    if (res && res.site && res.urls) {\n      if (res.layout) {\n        base.layout.id = res.layout.id;\n        base.layout.root = res.layout.root;\n        base.layout.meta = {};\n        if (base.layout.root) {\n          await scanComponent(base.layout.root.childs);\n          rebuildMeta(base.layout.meta, base.layout.root);\n        }\n      }\n\n      base.site = res.site;\n      base.site.code = { mode: \"vsc\" };\n      await injectSiteScript();\n\n      base.site.api = apiProxy(base.site.api_url);\n      base.site.db = dbProxy(base.site.api_url);\n\n      const w = window as any;\n      w.serverurl = base.site.api_url;\n      w.db = base.site.db;\n      w.api = base.site.api;\n\n      for (const item of res.urls) {\n        router.insert(item.url, item);\n        pages.push(item);\n      }\n    }\n  } catch (e) {}\n\n  return { router, pages };\n};\n\nconst injectSiteScript = () => {\n  return new Promise<void>((done) => {\n    const d = document;\n    const script = d.createElement(\"script\");\n    script.onload = async () => {\n      done();\n    };\n    let base_url = base.site.api_url;\n\n    if (base_url === \"*\") {\n      base_url = `${location.protocol}//${location.host}`;\n      base.site.api_url = base_url;\n    }\n    base_url = trim(base_url, \"/\");\n\n    if (!localStorage.getItem(\"api-ts-\" + base_url)) {\n      localStorage.setItem(\"api-ts-\" + base_url, Date.now().toString());\n    }\n\n    const cur = new URL(location.href);\n    cur.pathname = \"\";\n    if (\n      !base_url ||\n      (![\"prasi.avolut.com\"].includes(cur.hostname) && cur.port !== \"4550\")\n    ) {\n      cur.hash = \"\";\n      let cur_url = trim(cur.toString(), \"/\");\n      script.src = `${cur_url}/_prasi/load.js?url=${cur_url}&v3`;\n\n      base.site.api_url = `${cur.protocol}//${cur.host}`;\n    } else {\n      script.src = `${base_url}/_prasi/load.js?url=${base_url}&v3`;\n    }\n\n    script.onerror = () => {\n      done();\n    };\n\n    if (!document.querySelector(`script[src=\"${script.src}\"]`)) {\n      d.body.appendChild(script);\n    } else {\n      done();\n    }\n  });\n};\n\nexport const rebuildMeta = (meta: Record<string, IMeta>, root: IRoot) => {\n  for (const item of root.childs) {\n    genMeta(\n      {\n        set_meta: true,\n        comps: base.comp.list,\n        meta,\n        mode: \"page\",\n      },\n      { item }\n    );\n  }\n};\n","import { set as setkv } from \"idb-keyval\";\nimport { FC, useState } from \"react\";\nimport { validate } from \"uuid\";\nimport { GlobalContext, useLocal } from \"prasi-utils\";\nimport { IContent } from \"../../utils/types/general\";\nimport { IItem } from \"../../utils/types/item\";\nimport { IRoot } from \"../../utils/types/root\";\nimport { DeadEnd } from \"../../utils/ui/deadend\";\nimport { Loading } from \"../../utils/ui/loading\";\nimport { Vi } from \"../vi/vi\";\nimport { base } from \"./base/base\";\nimport { scanComponent } from \"./base/component\";\nimport { loadPage, loadUrls } from \"./base/page\";\nimport { detectResponsiveMode } from \"./base/responsive\";\nimport { initBaseRoute, rebuildMeta } from \"./base/route\";\nimport { w } from \"./w\";\nimport { MatchedRoute } from \"radix3\";\n\nexport const isPreview = () => {\n  return (\n    location.hostname.split(\".\").length === 4 ||\n    location.hostname === \"prasi.app\" ||\n    location.hostname === \"prasi.avolut.com\" ||\n    location.hostname.includes(\"ngrok\") ||\n    location.hostname === \"localhost\" ||\n    location.hostname === \"127.0.0.1\" ||\n    location.hostname === \"10.0.2.2\"\n  ); // android localhost\n};\n\nexport const Root = () => {\n  // #region context\n  const local = useLocal({ page_id: \"\" });\n  const [_, set] = useState({});\n  const render = () => set({});\n  w.prasiContext.render = render;\n  const Provider = GlobalContext.Provider as FC<{ value: any; children: any }>;\n  // #endregion\n\n  // #region init\n  const isPreviewProd = isPreview() && location.pathname.startsWith(\"/prod\");\n\n  if (\n    base.route.status !== \"ready\" ||\n    base.route.router?.ctx.rootNode.children.size === 0\n  ) {\n    if (base.route.status !== \"loading\") {\n      base.route.status = \"loading\";\n      initBaseRoute().then(async ({ router, pages }) => {\n        detectResponsiveMode();\n        base.route.status = \"ready\";\n        base.route.router = router;\n        base.route.pages = pages;\n\n        const basepath = w._prasi.basepath;\n        let url = `${\n          basepath.endsWith(\"/\") ? basepath : `${basepath}/`\n        }_prasi/code/index.js`;\n\n        const cur = new URL(location.href);\n        if (url.startsWith(\"/\")) {\n          url = `${cur.protocol}//${cur.host}${url}`;\n        }\n\n        const fn = new Function(\"callback\", `import(\"${url}\").then(callback)`);\n        await new Promise<void>((resolve) => {\n          fn((exports: any) => {\n            for (const [k, v] of Object.entries(exports)) {\n              (w as any)[k] = v;\n            }\n            resolve();\n          });\n        });\n\n        render();\n      });\n    }\n    return <Loading />;\n  }\n  // #endregion\n\n  // #region routing\n  const router = base.route.router;\n  if (!router) return <DeadEnd>Failed to create Router</DeadEnd>;\n\n  let page_id_from_url = \"\";\n  if (isPreviewProd) {\n    const parts = location.pathname.split(\"/\");\n    if (validate(parts[3])) {\n      page_id_from_url = parts[3];\n    }\n  }\n\n  let page: MatchedRoute<{\n    id: string;\n    url: string;\n  }> | null = null;\n\n  let page_found = null;\n  // hydrate page_id from server.ts\n  if (w._prasi.page_id) {\n    router.insert(base.pathname, {\n      id: w._prasi.page_id,\n      url: base.pathname,\n    });\n\n    page = { id: w._prasi.page_id, url: \"\", params: w._prasi.params };\n    w._prasi.routed = { page_id: w._prasi.page_id, params: w._prasi.params };\n    delete w._prasi.page_id;\n    delete w._prasi.params;\n  }\n  // regular route\n  else {\n    page = router.lookup(base.pathname);\n    if (page_id_from_url) {\n      const found = base.route.pages.find((e) => page_id_from_url === e.id);\n      page_found = found;\n      if (found) {\n        page = found;\n      }\n    }\n\n    if (\n      page &&\n      w._prasi.routed &&\n      w._prasi.routed.page_id === page.id &&\n      w._prasi.routed.params\n    ) {\n      page.params = w._prasi.routed.params;\n    }\n  }\n\n  if (!page) {\n    console.error(\"Page Not Found:\", page, base);\n    return <DeadEnd>Page Not Found</DeadEnd>;\n  }\n\n  if (page.id !== local.page_id) {\n    base.init_local_effect = {};\n  }\n\n  w.params = page.params || {};\n\n  base.page.id = page.id;\n  base.page.url = page.url;\n  const cache = base.page.cache[page.id];\n\n  if (!cache) {\n    loadPage(page.id)\n      .then(async ({ root }) => {\n        if (page) {\n          const p = {\n            id: page.id,\n            url: page.url,\n            root,\n            meta: {},\n          };\n          await scanComponent(root.childs, true);\n          rebuildMeta(p.meta, root);\n          base.page.cache[p.id] = p;\n          render();\n        }\n      })\n      .catch(() => {\n        render();\n      });\n\n    return <Loading note=\"Loading page\" />;\n  } else {\n    base.page.root = cache.root;\n    base.page.meta = cache.meta;\n  }\n  // #endregion\n\n  let mobileCSS = \"\";\n\n  if (base.page.root.responsive === \"mobile\" || base.mode === \"mobile\") {\n    base.mode = \"mobile\";\n    mobileCSS = css`\n      @media (min-width: 1280px) {\n        border-left: 1px solid #ccc;\n        border-right: 1px solid #ccc;\n        width: 375px;\n        top: 0px;\n        overflow-x: hidden;\n        overflow-y: auto;\n        bottom: 0px;\n      }\n      @media (max-width: 1279px) {\n        left: 0px;\n        right: 0px;\n        top: 0px;\n        bottom: 0px;\n        overflow-y: auto;\n      }\n    `;\n  } else if (base.page.root.responsive === \"desktop\") {\n    base.mode = \"desktop\";\n  }\n\n  return (\n    <Provider value={w.prasiContext}>\n      <div\n        className={cx(\"relative flex flex-1 items-center justify-center\")}\n        onPointerLeave={() => {\n          w.pointerActive = false;\n        }}\n        onPointerEnter={() => {\n          w.pointerActive = true;\n        }}\n      >\n        <div\n          className={cx(\n            \"absolute flex flex-col items-stretch flex-1 bg-white main-content-preview\",\n            base.mode === \"mobile\" ? mobileCSS : \"inset-0 overflow-auto\",\n            css`\n              contain: content;\n            `\n          )}\n        >\n          <Vi\n            api_url={base.site.api_url}\n            entry={Object.values(base.page.root.childs)\n              .filter((e) => e)\n              .map((e) => e.id)}\n            meta={base.page.meta}\n            mode={base.mode}\n            page_id={base.page.id}\n            site_id={base.site.id}\n            db={base.site.db}\n            api={base.site.api}\n            preloaded={(url) => {\n              const found = base.route.router?.lookup(url);\n              if (found) {\n                if (base.page.cache[found.id]) {\n                  return true;\n                }\n              }\n              return false;\n            }}\n            comp_load={async (comp_id) => {\n              const comp = base.comp;\n              if (comp.list[comp_id]) {\n                return comp.list[comp_id];\n              }\n              try {\n                const res = (await (\n                  await fetch(base.url`_prasi/comp`, {\n                    method: \"POST\",\n                    body: JSON.stringify({ ids: [comp_id] }),\n                  })\n                ).json()) as Record<string, IItem>;\n                for (const [id, item] of Object.entries(res)) {\n                  delete comp.pending[id];\n                  comp.list[id] = item;\n\n                  await setkv(`comp-${id}`, item);\n                }\n              } catch (e) {}\n\n              return comp.list[comp_id];\n            }}\n            layout={\n              base.layout.id && base.layout.root && base.layout.meta\n                ? {\n                    id: base.layout.id,\n                    meta: base.layout.meta,\n                    entry: Object.values(base.layout.root.childs)\n                      .filter((e) => e)\n                      .map((e) => e.id),\n                  }\n                : undefined\n            }\n            script={{ init_local_effect: base.init_local_effect }}\n            on_preload={async ({ urls, opt }) => {\n              const load_urls: string[] = [];\n              if (base.cache.urls) {\n                for (const url of urls) {\n                  if (!base.cache.urls.has(url)) {\n                    load_urls.push(url);\n                    base.cache.urls.add(url);\n                  }\n                }\n              }\n\n              if (load_urls.length > 0) {\n                const pages = await loadUrls(load_urls);\n\n                if (opt?.on_load) {\n                  opt.on_load(pages, walkRoot);\n                }\n\n                if (Array.isArray(pages)) {\n                  for (const page of pages) {\n                    const p = {\n                      id: page.id,\n                      url: page.url,\n                      root: page.root,\n                      meta: {},\n                    };\n                    await scanComponent(page.root.childs);\n                    rebuildMeta(p.meta, page.root);\n                    base.page.cache[p.id] = p;\n                  }\n                }\n              }\n            }}\n          />\n        </div>\n      </div>\n    </Provider>\n  );\n};\n\nconst walkRoot = (\n  pages: { root: IRoot }[],\n  visit: (item: IContent) => void | Promise<void>\n) => {\n  for (const page of pages) {\n    for (const child of page.root.childs) {\n      walk(child, visit);\n    }\n  }\n};\n\nconst walk = (\n  item: IContent,\n  visit: (item: IContent) => void | Promise<void>\n) => {\n  visit(item);\n\n  if (item.type !== \"text\") {\n    if (item.type === \"item\" && item.component?.props) {\n      for (const prop of Object.values(item.component.props)) {\n        if (prop.content) {\n          walk(prop.content, visit);\n        }\n      }\n    }\n\n    for (const child of item.childs) {\n      walk(child, visit);\n    }\n  }\n};\n","export const w = window as unknown as {\n  prasiContext: {\n    global: any;\n    render: () => void;\n  };\n  params: any;\n  navigateOverride: (href: string) => void;\n  pointerActive: boolean\n  _prasi: {\n    basepath: string;\n    page_id?: string;\n    params?: any;\n    routed?: {\n      page_id?: string;\n      params?: any;\n    };\n  };\n};\n"],"names":["useLocal","data","effect","deps","_render","useState","local","_","useRef","useEffect","arg","Date","clearTimeout","setTimeout","console","k","dep","Object","waitUntil","condition","timeout","Promise","resolve","tout","c","setInterval","clearInterval","GlobalContext","createContext","useGlobal","defaultValue","id","global","render","useContext","res","reset","undefined","startTransition","deepClone","decircular","defineReact","w","window","globalThis","React","ReactDOM","JSXRuntime","JSXDevRuntime","defineWindow","awaitServerUrl","location","host","scheme","serverURL","URL","port","css","extractCss","classNames","result","e","Array","f","href","_href","history","sw","navigator","_w__prasi","base","_key","initBaseConfig","div","document","react","createRoot","internal_url","patharr","prasi_internal","isPreview","Root","DeadEnd","children","back","Loading","className","show","backdrop","note","alt","pointer","CustomLoading","cx","viLoad","vi","ViGlobal","ErrorBox","withErrorBoundary","meta","silent","error","resetError","useErrorBoundary","errorInfo","_meta","responsiveVal","item","key","mode","defaultVal","value","cssAdv","cur","adv","cssBackground","bg","bgurl","serverurl","cssBorder","border","pick","obj","attr","notpx","val","get","cssDimension","editor","dim","cssEditor","hover","active","glbFont","cssFont","font","fontName","doc","link","cssLayout","layout","cssPadding","padding","produceCSS","viParts","is_layout","passprop","depth","_item_component","_meta_item_adv","_meta_item_adv1","inherit","props","childs","target","localStorage","createRouter","parseInt","JSON","viScriptArg","imported","codeBuild","codes","filePath","store","createStore","nav","extractNavigate","str","found_nav","findBetween","page_id","url","Set","text","opener","closer","i","last","founds","startIndex","char","end","found","createViPassProp","internal_key","script","filtered_args","is_changed","v","_pass","isValidElement","is_meta","cmeta","citem","ref_item","ViRender","child_id","local_cached_value","createViLocal","_vi_script","_vi_layout","_meta_script","isEditor","devItem","metas","mitem","_added","added","pedit","initChanges","changes","_mitem_get_get_get","content","vbuilt","fn","Function","compile","_mitem_doc","_item_component1","item_id","src","removeEditFromChilds","createId","code_result","done","m","syncronize","name","Error","_item_component2","_mitem_get_get_get1","child","_metas_parent_id","_mitem_parent","_mitem_parent_parent_parent","parent","parent_id","parent_meta","complexifyProps","compileValueBuilt","prodItem","_item_component_props_k","_meta_parent","viEvalScript","parent_key","parts","exports","viEvalProps","_meta_item_component","ViScript","_set","ViChild","JS_CONFIG","render_stat","_rstat_meta_meta_item_id","_rstat_meta_meta_item_id1","rstat_meta","Math","spaces","idx","Fragment","initExtNotif","prasi_ext","raw","_w_notif","_w_notif1","_w_notif2","_w_notif3","_w_notif4","_w_notif5","ival","user_id","_prasi_ext_notif","notif","initExts","pe","msg","ViRoot","_vi_layout1","_vi_layout2","entry","Vi","api_url","site_id","api","db","visit","preloaded","rs","on_status_changed","on_preload","comp_load","pathname","forceOriginal","u","path","_urls","opt","navs","all_done","pages","Suspense","scanComponent","items","from_root","comp","scanSingle","pending","pendingPage","loadPage","returned","cached","detectResponsiveMode","p","parsed","parseUA","BigInt","g","fetchViaProxy","target_url","_headers","parse_json","headers","body","isFile","uploadProgress","files","File","fd","FormData","file","to_url","cur_url","final_url","encodeURIComponent","axios","fetch","replacer","getProxyUrl","loadApiProxyDef","_url","with_types","trim","d","url_target","url_cur","is_remote","apiProxyLoaded","apiProxy","base_url","Proxy","actionName","proxy","createFn","schema_promise","db_mode","dbProxy","dburl","fetchSendDb","table","batch","params","bytes","pako","btoa","acc","current","String","action","editorQueryLoaded","_params","hsum","hash_sum","instantiate","item_comp","ids","newitem","walkChild","cprop","nprop","walkProp","_arg_item_comp_component","_arg_item_component","a","b","prop","simplifyItemChild","genComp","_arg_parent","_p_on","_arg_parent_comp_component","_arg_parent2","_p_on1","_arg_parent3","_child_name","instances","instance","_prop_meta","comp_id","genMeta","_arg_parent1","_arg_parent4","_arg_parent5","carg","getRoute","initBaseRoute","router","rebuildMeta","injectSiteScript","root","_base_route_router","set","Provider","isPreviewProd","basepath","page_id_from_url","validate","page","page_found","cache","mobileCSS"],"mappings":"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"}